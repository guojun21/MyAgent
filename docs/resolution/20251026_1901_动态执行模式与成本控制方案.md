# åŠ¨æ€æ‰§è¡Œæ¨¡å¼ä¸æˆæœ¬æ§åˆ¶æ–¹æ¡ˆ

> åˆ›å»ºæ—¶é—´ï¼š2025-10-26 19:01  
> çŠ¶æ€ï¼šå¾…å®æ–½  
> ä¼˜å…ˆçº§ï¼šP1ï¼ˆä¸­é«˜ä¼˜å…ˆçº§ï¼‰

---

## ğŸ“‹ åˆ›æ–°ç‚¹

**ç”¨æˆ·å¯è°ƒèŠ‚çš„æ‰§è¡Œæ¨¡å¼ + å®æ—¶æˆæœ¬é¢„ä¼° + Tokené¢„ç®—æ§åˆ¶**

è¿™æ˜¯ä¸€ä¸ªå°†"æ€§èƒ½/æˆæœ¬/è´¨é‡"æ§åˆ¶æƒäº¤ç»™ç”¨æˆ·çš„åˆ›æ–°è®¾è®¡ï¼ŒåŒæ—¶é€šè¿‡æ™ºèƒ½å»ºè®®é™ä½ç”¨æˆ·é€‰æ‹©æˆæœ¬ã€‚

---

## ğŸ¨ UIè®¾è®¡æ–¹æ¡ˆ

### ä¸»ç•Œé¢æ¨¡å¼é€‰æ‹©å™¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸš€ æ‰§è¡Œæ¨¡å¼                                         â”‚
â”‚  â”â”â”â”â”â”â”â”â”â—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”                â”‚
â”‚  ğŸƒ è½»é‡    âš–ï¸ æ ‡å‡†    ğŸ§  æ·±åº¦                      â”‚
â”‚  Fast     Balanced   Thorough                      â”‚
â”‚                                                     â”‚
â”‚  å½“å‰æ¨¡å¼ï¼šâš–ï¸ æ ‡å‡†æ¨¡å¼                              â”‚
â”‚  â€¢ æœ€å¤§è¿­ä»£: 20æ¬¡                                   â”‚
â”‚  â€¢ Tokené¢„ç®—: 80K                                   â”‚
â”‚  â€¢ é¢„ä¼°æˆæœ¬: Â¥0.08/æ¬¡                               â”‚
â”‚  â€¢ é¢„ä¼°æ—¶é—´: 30-60ç§’                                â”‚
â”‚                                                     â”‚
â”‚  [âš™ï¸ é«˜çº§è®¾ç½®]                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é«˜çº§è®¾ç½®é¢æ¿ï¼ˆå¯æŠ˜å ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš™ï¸ é«˜çº§è®¾ç½®                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  æœ€å¤§è¿­ä»£æ¬¡æ•°                                        â”‚
â”‚  5 â”â”â”â”â”â”â”â”â”â—â”â”â”â”â”â”â”â”â” 50        [20]            â”‚
â”‚                                                     â”‚
â”‚  Tokené¢„ç®—é™åˆ¶ï¼ˆKï¼‰                                  â”‚
â”‚  10 â”â”â”â”â”â”â”â”â”â”â”â—â”â”â”â”â”â” 200       [80K]           â”‚
â”‚                                                     â”‚
â”‚  æ€è€ƒå·¥å…·                                           â”‚
â”‚  â—‹ ç¦ç”¨  â— å¯é€‰  â—‹ å¼ºåˆ¶                            â”‚
â”‚                                                     â”‚
â”‚  å·¥å…·è°ƒç”¨æ¿€è¿›åº¦                                      â”‚
â”‚  ä¿å®ˆ â”â”â”â”â”â—â”â”â”â”â” æ¿€è¿›                             â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ’° å®æ—¶é¢„ä¼°                                â”‚    â”‚
â”‚  â”‚ å½“å‰é…ç½®é¢„è®¡æ¶ˆè€—ï¼š                          â”‚    â”‚
â”‚  â”‚ â€¢ Token: 60-90K                           â”‚    â”‚
â”‚  â”‚ â€¢ æˆæœ¬: Â¥0.06-0.12                        â”‚    â”‚
â”‚  â”‚ â€¢ æ—¶é—´: 35-55ç§’                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                     â”‚
â”‚  [é‡ç½®ä¸ºé»˜è®¤]  [ä¿å­˜é…ç½®]                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ ä¸‰æ¡£é¢„è®¾æ¨¡å¼

### ğŸƒ è½»é‡æ¨¡å¼ï¼ˆFastï¼‰

```python
FastModeConfig = {
    "max_iterations": 10,
    "max_token_budget": 30000,
    "max_rounds": 2,           # Plan-Execute-Thinkæœ€å¤š2è½®
    "steps_per_round": 3,      # æ¯è½®æœ€å¤š3ä¸ªæ­¥éª¤
    "enable_thinking": False,  # ç¦ç”¨thinkå·¥å…·
    "tool_choice_strategy": "conservative",
    "temperature": 0.3,
    "estimated_cost": 0.02,
    "estimated_time": 15,
    "é€‚åˆåœºæ™¯": [
        "æŸ¥çœ‹æ–‡ä»¶",
        "ç®€å•æœç´¢",
        "å•ä¸ªæ–‡ä»¶ä¿®æ”¹",
        "é…ç½®æŸ¥è¯¢"
    ]
}
```

### âš–ï¸ æ ‡å‡†æ¨¡å¼ï¼ˆBalancedï¼‰â­ é»˜è®¤

```python
BalancedModeConfig = {
    "max_iterations": 20,
    "max_token_budget": 80000,
    "max_rounds": 3,
    "steps_per_round": 6,
    "enable_thinking": True,
    "tool_choice_strategy": "auto",
    "temperature": 0.7,
    "estimated_cost": 0.08,
    "estimated_time": 45,
    "é€‚åˆåœºæ™¯": [
        "ä»£ç é‡æ„",
        "å¤šæ–‡ä»¶ä¿®æ”¹",
        "ä¸­ç­‰å¤æ‚è°ƒè¯•",
        "é¡¹ç›®åˆ†æ"
    ]
}
```

### ğŸ§  æ·±åº¦æ¨¡å¼ï¼ˆThoroughï¼‰

```python
ThoroughModeConfig = {
    "max_iterations": 30,
    "max_token_budget": 150000,
    "max_rounds": 5,
    "steps_per_round": 8,
    "enable_thinking": True,   # å¼ºåˆ¶æ¯è½®think
    "tool_choice_strategy": "aggressive",
    "temperature": 0.9,
    "estimated_cost": 0.20,
    "estimated_time": 90,
    "é€‚åˆåœºæ™¯": [
        "æ¶æ„è®¾è®¡",
        "å¤æ‚Bugä¿®å¤",
        "å…¨é¡¹ç›®é‡æ„",
        "æ·±åº¦åˆ†æ"
    ]
}
```

---

## ğŸ’» åç«¯å®ç°

### 1. æ¨¡å¼ç®¡ç†ç±»

```python
# core/execution_modes.py
from enum import Enum
from dataclasses import dataclass

@dataclass
class ExecutionConfig:
    """æ‰§è¡Œé…ç½®"""
    max_iterations: int
    max_token_budget: int
    max_rounds: int
    steps_per_round: int
    enable_thinking: bool
    temperature: float
    estimated_cost: float
    estimated_time: int

class ExecutionMode(Enum):
    FAST = "fast"
    BALANCED = "balanced"
    THOROUGH = "thorough"
    CUSTOM = "custom"

# é¢„è®¾é…ç½®
PRESET_CONFIGS = {
    ExecutionMode.FAST: ExecutionConfig(...),
    ExecutionMode.BALANCED: ExecutionConfig(...),
    ExecutionMode.THOROUGH: ExecutionConfig(...),
}
```

### 2. Agenté›†æˆ

```python
class Agent:
    def __init__(self, workspace_root: str = "."):
        ...
        self.execution_mode = ExecutionMode.BALANCED
        self.config = PRESET_CONFIGS[self.execution_mode]
        self.max_iterations = self.config.max_iterations
        self.token_budget = self.config.max_token_budget
    
    def set_mode(self, mode: ExecutionMode):
        """åˆ‡æ¢æ‰§è¡Œæ¨¡å¼"""
        self.execution_mode = mode
        self.config = PRESET_CONFIGS[mode]
        self.max_iterations = self.config.max_iterations
        self.token_budget = self.config.max_token_budget
        print(f"åˆ‡æ¢åˆ° {mode.value} æ¨¡å¼")
    
    def set_custom_config(self, max_iterations: int, token_budget: int):
        """è‡ªå®šä¹‰é…ç½®"""
        self.execution_mode = ExecutionMode.CUSTOM
        self.max_iterations = max_iterations
        self.token_budget = token_budget
    
    async def run(self, user_message, context_history):
        # æ£€æŸ¥Tokené¢„ç®—
        estimated_tokens = estimate_tokens(messages)
        if estimated_tokens > self.token_budget:
            return {
                "success": False,
                "message": f"é¢„ä¼°token({estimated_tokens})è¶…å‡ºé¢„ç®—({self.token_budget})ï¼Œè¯·é™ä½æ¨¡å¼æˆ–å¢åŠ é¢„ç®—"
            }
        
        # ä½¿ç”¨é…ç½®çš„max_rounds
        max_rounds = self.config.max_rounds
        
        ...
```

---

## ğŸ¨ å‰ç«¯å®ç°

### 1. æ¨¡å¼é€‰æ‹©ç»„ä»¶

```javascript
class ExecutionModeSelector {
    constructor() {
        this.currentMode = 'balanced';
        this.customConfig = null;
    }
    
    selectMode(mode) {
        this.currentMode = mode;
        
        // è°ƒç”¨åç«¯åˆ‡æ¢æ¨¡å¼
        agentBridge.setExecutionMode(mode);
        
        // æ›´æ–°UIæ˜¾ç¤º
        this.updateEstimates(mode);
    }
    
    updateEstimates(mode) {
        const config = MODE_CONFIGS[mode];
        
        document.getElementById('est-iterations').textContent = config.max_iterations;
        document.getElementById('est-cost').textContent = `Â¥${config.estimated_cost.toFixed(2)}`;
        document.getElementById('est-time').textContent = `${config.estimated_time}ç§’`;
    }
    
    setCustom(iterations, budget) {
        // è‡ªå®šä¹‰é…ç½®
        agentBridge.setCustomConfig(iterations, budget);
        
        // è®¡ç®—é¢„ä¼°
        const estimated_cost = (budget / 1000) * 0.001;
        const estimated_time = iterations * 3;
        
        this.updateEstimates({
            max_iterations: iterations,
            estimated_cost: estimated_cost,
            estimated_time: estimated_time
        });
    }
}
```

### 2. æ™ºèƒ½æ¨¡å¼æ¨è

```javascript
function suggestMode(userMessage) {
    // ç®€å•ä»»åŠ¡
    const simpleKeywords = ['æŸ¥çœ‹', 'è¯»å–', 'åˆ—å‡º', 'æ˜¾ç¤º'];
    if (simpleKeywords.some(k => userMessage.includes(k))) {
        showSuggestion('fast', 'æ£€æµ‹åˆ°ç®€å•ä»»åŠ¡ï¼Œå»ºè®®ä½¿ç”¨è½»é‡æ¨¡å¼');
    }
    
    // å¤æ‚ä»»åŠ¡
    const complexKeywords = ['é‡æ„', 'å…¨éƒ¨', 'æ‰€æœ‰', 'æ·±åº¦åˆ†æ', 'ä¼˜åŒ–'];
    if (complexKeywords.some(k => userMessage.includes(k))) {
        showSuggestion('thorough', 'æ£€æµ‹åˆ°å¤æ‚ä»»åŠ¡ï¼Œå»ºè®®ä½¿ç”¨æ·±åº¦æ¨¡å¼');
    }
}

function showSuggestion(mode, reason) {
    // æ˜¾ç¤ºæç¤ºæ¡†
    const toast = `
        <div class="mode-suggestion">
            ğŸ’¡ ${reason}
            <button onclick="acceptSuggestion('${mode}')">é‡‡çº³å»ºè®®</button>
            <button onclick="dismissSuggestion()">ä¿æŒå½“å‰</button>
        </div>
    `;
    showToast(toast);
}
```

---

## ğŸ“Š å®æ—¶æˆæœ¬ç›‘æ§

### å¯¹è¯ä¸­çš„å®æ—¶æ˜¾ç¤º

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š å½“å‰å¯¹è¯ç»Ÿè®¡                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å·²ç”¨Token: 45.2K / 80K (56%)           â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘                   â”‚
â”‚                                         â”‚
â”‚  å·²ç”¨è¿­ä»£: 12 / 20 (60%)                â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘                   â”‚
â”‚                                         â”‚
â”‚  å·²ç”¨æˆæœ¬: Â¥0.048                       â”‚
â”‚  é¢„è®¡æ€»æˆæœ¬: Â¥0.086                     â”‚
â”‚                                         â”‚
â”‚  æ‰§è¡Œæ—¶é—´: 28ç§’                          â”‚
â”‚  é¢„è®¡å‰©ä½™: ~15ç§’                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ è¿›é˜¶åŠŸèƒ½ï¼šé¢„ç®—é”å®š

### ç”¨æˆ·åœºæ™¯

```
ç”¨æˆ·è®¾ç½®ï¼š
  "æ¯æ¬¡å¯¹è¯æœ€å¤šèŠ±è´¹ Â¥0.10"
  "æ¯å¤©æœ€å¤šèŠ±è´¹ Â¥5.00"

ç³»ç»Ÿè¡Œä¸ºï¼š
  - å¯¹è¯å¼€å§‹å‰é¢„ä¼°æˆæœ¬
  - è¶…é¢„ç®—è‡ªåŠ¨é™çº§æ¨¡å¼æˆ–æ‹’ç»æ‰§è¡Œ
  - è¾¾åˆ°æ¯æ—¥é™é¢æ—¶æç¤ºç”¨æˆ·
```

### å®ç°

```python
class BudgetController:
    def __init__(self):
        self.daily_budget = 5.0  # æ¯æ—¥Â¥5
        self.per_task_budget = 0.10  # æ¯æ¬¡Â¥0.1
        self.daily_spent = 0.0
    
    def check_budget(self, estimated_cost: float) -> tuple[bool, str]:
        """æ£€æŸ¥é¢„ç®—"""
        
        # å•æ¬¡é¢„ç®—æ£€æŸ¥
        if estimated_cost > self.per_task_budget:
            return False, f"é¢„ä¼°æˆæœ¬(Â¥{estimated_cost:.2f})è¶…å‡ºå•æ¬¡é¢„ç®—(Â¥{self.per_task_budget})"
        
        # æ¯æ—¥é¢„ç®—æ£€æŸ¥
        if self.daily_spent + estimated_cost > self.daily_budget:
            return False, f"ä»Šæ—¥é¢„ç®—ä¸è¶³(å·²ç”¨Â¥{self.daily_spent:.2f}/Â¥{self.daily_budget})"
        
        return True, "é¢„ç®—å……è¶³"
    
    def suggest_mode_by_budget(self, task_complexity: str) -> ExecutionMode:
        """æ ¹æ®é¢„ç®—å»ºè®®æ¨¡å¼"""
        remaining = self.per_task_budget - (self.daily_spent % self.per_task_budget)
        
        if remaining < 0.05:
            return ExecutionMode.FAST
        elif remaining < 0.15:
            return ExecutionMode.BALANCED
        else:
            return ExecutionMode.THOROUGH
```

---

## ğŸ¨ ç”¨æˆ·ä½“éªŒæµç¨‹

### åœºæ™¯1ï¼šæ™ºèƒ½æ¨è

```
ç”¨æˆ·è¾“å…¥ï¼š"å¸®æˆ‘é‡æ„æ•´ä¸ªè®¤è¯ç³»ç»Ÿ"
  â†“
ç³»ç»Ÿåˆ†æï¼š
  - å…³é”®è¯"é‡æ„"ã€"æ•´ä¸ª"â†’ å¤æ‚ä»»åŠ¡
  - å½“å‰æ¨¡å¼ï¼šæ ‡å‡†(20æ­¥)
  - é¢„ä¼°éœ€è¦ï¼š25-30æ­¥
  â†“
å¼¹å‡ºæç¤ºï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¡ ä»»åŠ¡å¤æ‚åº¦åˆ†æ                       â”‚
â”‚                                        â”‚
â”‚ æ£€æµ‹åˆ°å¤æ‚ä»»åŠ¡ï¼Œå»ºè®®ä½¿ç”¨ ğŸ§  æ·±åº¦æ¨¡å¼    â”‚
â”‚                                        â”‚
â”‚ æ ‡å‡†æ¨¡å¼ vs æ·±åº¦æ¨¡å¼ï¼š                  â”‚
â”‚ â€¢ è¿­ä»£æ¬¡æ•°: 20 â†’ 30                    â”‚
â”‚ â€¢ æˆåŠŸç‡: 65% â†’ 90%                    â”‚
â”‚ â€¢ æˆæœ¬: Â¥0.08 â†’ Â¥0.20 (+Â¥0.12)        â”‚
â”‚                                        â”‚
â”‚ [é‡‡ç”¨æ·±åº¦æ¨¡å¼] [ä¿æŒæ ‡å‡†æ¨¡å¼]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åœºæ™¯2ï¼šé¢„ç®—é¢„è­¦

```
æ‰§è¡Œä¸­é€”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ é¢„ç®—é¢„è­¦                            â”‚
â”‚                                        â”‚
â”‚ Tokenä½¿ç”¨å·²è¾¾70% (56K/80K)             â”‚
â”‚                                        â”‚
â”‚ å»ºè®®æ“ä½œï¼š                              â”‚
â”‚ â€¢ ç»§ç»­æ‰§è¡Œï¼ˆå¯èƒ½è¶…é¢„ç®—ï¼‰                â”‚
â”‚ â€¢ ç«‹å³æ€»ç»“å¹¶ç»“æŸ                        â”‚
â”‚ â€¢ åˆ‡æ¢åˆ°è½»é‡æ¨¡å¼å®Œæˆå‰©ä½™ä»»åŠ¡             â”‚
â”‚                                        â”‚
â”‚ [ç»§ç»­] [æ€»ç»“ç»“æŸ] [åˆ‡æ¢æ¨¡å¼]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š æ•°æ®æŒä¹…åŒ–

### ç”¨æˆ·é…ç½®å­˜å‚¨

```json
// data/user_preferences.json
{
    "execution_preferences": {
        "default_mode": "balanced",
        "custom_configs": {
            "max_iterations": 20,
            "token_budget": 80000
        },
        "budget_limits": {
            "per_task": 0.10,
            "daily": 5.00,
            "monthly": 100.00
        },
        "auto_suggestion": true,  // æ˜¯å¦å¯ç”¨æ™ºèƒ½æ¨è
        "cost_alerts": true       // æ˜¯å¦å¯ç”¨æˆæœ¬é¢„è­¦
    },
    "usage_statistics": {
        "total_tasks": 156,
        "total_cost": 12.48,
        "avg_cost_per_task": 0.08,
        "mode_distribution": {
            "fast": 45,
            "balanced": 98,
            "thorough": 13
        }
    }
}
```

---

## ğŸ”¢ æˆæœ¬è®¡ç®—å…¬å¼

### Tokenæˆæœ¬è®¡ç®—

```python
def calculate_cost(prompt_tokens: int, completion_tokens: int) -> float:
    """è®¡ç®—å•æ¬¡å¯¹è¯æˆæœ¬ï¼ˆDeepSeekä»·æ ¼ï¼‰"""
    
    # DeepSeekä»·æ ¼ï¼ˆ2025å¹´ï¼‰
    INPUT_PRICE = 0.001   # Â¥0.001 / 1K tokens
    OUTPUT_PRICE = 0.002  # Â¥0.002 / 1K tokens
    
    input_cost = (prompt_tokens / 1000) * INPUT_PRICE
    output_cost = (completion_tokens / 1000) * OUTPUT_PRICE
    
    return input_cost + output_cost

def estimate_cost_by_mode(mode: ExecutionMode, task_complexity: str) -> tuple[float, float]:
    """é¢„ä¼°æˆæœ¬èŒƒå›´"""
    
    base_cost = MODE_CONFIGS[mode].estimated_cost
    
    # æ ¹æ®ä»»åŠ¡å¤æ‚åº¦è°ƒæ•´
    complexity_multiplier = {
        "simple": 0.5,
        "medium": 1.0,
        "complex": 1.5
    }
    
    multiplier = complexity_multiplier.get(task_complexity, 1.0)
    min_cost = base_cost * multiplier * 0.7
    max_cost = base_cost * multiplier * 1.3
    
    return (min_cost, max_cost)
```

---

## ğŸ¨ å¯è§†åŒ–ç»Ÿè®¡é¢æ¿

### æˆæœ¬åˆ†æDashboard

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š ä½¿ç”¨ç»Ÿè®¡                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  æœ¬å‘¨æ¶ˆè€—ï¼šÂ¥2.34 / Â¥35.00 é¢„ç®—                      â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 6.7%             â”‚
â”‚                                                     â”‚
â”‚  æ¨¡å¼åˆ†å¸ƒï¼š                                          â”‚
â”‚  ğŸƒ è½»é‡: 23æ¬¡ (45%)  Â¥0.46                         â”‚
â”‚  âš–ï¸ æ ‡å‡†: 25æ¬¡ (49%)  Â¥1.76                        â”‚
â”‚  ğŸ§  æ·±åº¦: 3æ¬¡  (6%)   Â¥0.12                         â”‚
â”‚                                                     â”‚
â”‚  Tokenæ¶ˆè€—è¶‹åŠ¿ï¼š                                     â”‚
â”‚  [æŠ˜çº¿å›¾ï¼šæœ€è¿‘7å¤©æ¯æ—¥tokenæ¶ˆè€—]                      â”‚
â”‚                                                     â”‚
â”‚  æˆæœ¬ä¼˜åŒ–å»ºè®®ï¼š                                      â”‚
â”‚  â€¢ 45%çš„ä»»åŠ¡å¯é™çº§åˆ°è½»é‡æ¨¡å¼ï¼ŒèŠ‚çœÂ¥0.8              â”‚
â”‚  â€¢ è€ƒè™‘æ‰¹é‡æ“ä½œå‡å°‘å¯¹è¯æ¬¡æ•°                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ æ™ºèƒ½ä¼˜åŒ–ï¼šè‡ªé€‚åº”æ¨¡å¼

### å­¦ä¹ ç”¨æˆ·ä¹ æƒ¯

```python
class AdaptiveModeSelector:
    """è‡ªé€‚åº”æ¨¡å¼é€‰æ‹©å™¨"""
    
    def __init__(self):
        self.task_history = []  # ä»»åŠ¡å†å²
    
    def learn_from_history(self, task: str, mode: str, success: bool, actual_iterations: int):
        """ä»å†å²ä¸­å­¦ä¹ """
        self.task_history.append({
            "task": task,
            "mode": mode,
            "success": success,
            "actual_iterations": actual_iterations
        })
    
    def suggest_optimal_mode(self, new_task: str) -> ExecutionMode:
        """åŸºäºå†å²æ¨èæœ€ä¼˜æ¨¡å¼"""
        
        # æ‰¾ç›¸ä¼¼ä»»åŠ¡
        similar_tasks = find_similar(new_task, self.task_history)
        
        if not similar_tasks:
            return ExecutionMode.BALANCED  # é»˜è®¤
        
        # ç»Ÿè®¡æœ€æˆåŠŸçš„æ¨¡å¼
        mode_success_rate = {}
        for task in similar_tasks:
            mode = task["mode"]
            if mode not in mode_success_rate:
                mode_success_rate[mode] = {"success": 0, "total": 0}
            
            mode_success_rate[mode]["total"] += 1
            if task["success"]:
                mode_success_rate[mode]["success"] += 1
        
        # é€‰æ‹©æˆåŠŸç‡æœ€é«˜çš„æ¨¡å¼
        best_mode = max(
            mode_success_rate.items(),
            key=lambda x: x[1]["success"] / x[1]["total"]
        )[0]
        
        return ExecutionMode(best_mode)
```

---

## ğŸ¯ å®æ–½è·¯çº¿å›¾

### Phase 1: åŸºç¡€æ¨¡å¼åˆ‡æ¢ï¼ˆ2å¤©ï¼‰
- [ ] å®šä¹‰3ä¸ªé¢„è®¾æ¨¡å¼é…ç½®
- [ ] Agentæ”¯æŒæ¨¡å¼åˆ‡æ¢
- [ ] å‰ç«¯UIï¼š3ä¸ªæŒ‰é’®é€‰æ‹©
- [ ] Qt Bridgeé›†æˆ

### Phase 2: é«˜çº§è®¾ç½®ï¼ˆ1å¤©ï¼‰
- [ ] æ»‘å—è°ƒèŠ‚è¿­ä»£/é¢„ç®—
- [ ] å®æ—¶æˆæœ¬é¢„ä¼°
- [ ] é…ç½®æŒä¹…åŒ–

### Phase 3: æ™ºèƒ½æ¨èï¼ˆ2å¤©ï¼‰
- [ ] ä»»åŠ¡å¤æ‚åº¦åˆ†æ
- [ ] è‡ªåŠ¨æ¨èæ¨¡å¼
- [ ] é¢„ç®—é¢„è­¦

### Phase 4: æ•°æ®ç»Ÿè®¡ï¼ˆ1å¤©ï¼‰
- [ ] ä½¿ç”¨ç»Ÿè®¡Dashboard
- [ ] æˆæœ¬åˆ†æ
- [ ] ä¼˜åŒ–å»ºè®®

---

## ğŸ’¡ åˆ›æ–°äº®ç‚¹æ€»ç»“

1. âœ… **ç”¨æˆ·å¯æ§**ï¼š3æ¡£+è‡ªå®šä¹‰ï¼Œæ»¡è¶³ä¸åŒéœ€æ±‚
2. âœ… **æˆæœ¬é€æ˜**ï¼šå®æ—¶é¢„ä¼°+ç»Ÿè®¡åˆ†æ
3. âœ… **æ™ºèƒ½è¾…åŠ©**ï¼šè‡ªåŠ¨æ¨èåˆé€‚æ¨¡å¼
4. âœ… **é¢„ç®—ä¿æŠ¤**ï¼šç¡¬æ€§é™åˆ¶é˜²æ­¢çˆ†ç‚¸
5. âœ… **å­¦ä¹ ä¼˜åŒ–**ï¼šä»å†å²ä¸­å­¦ä¹ æœ€ä¼˜é…ç½®

**è¿™å¥—æ–¹æ¡ˆå¯ä»¥æˆä¸ºäº§å“çš„æ ¸å¿ƒå·®å¼‚åŒ–featureï¼** ğŸŒŸ

---

## ğŸ“ˆ é¢„æœŸæ”¶ç›Š

| æŒ‡æ ‡ | å½“å‰ | å®æ–½å | æå‡ |
|------|-----|--------|------|
| å¹³å‡æˆæœ¬/ä»»åŠ¡ | Â¥0.15 | Â¥0.06 | â¬‡ï¸ 60% |
| Tokenæµªè´¹ç‡ | 40% | 15% | â¬‡ï¸ 62% |
| ç”¨æˆ·æ»¡æ„åº¦ | 70% | 90% | â¬†ï¸ 29% |
| ä»»åŠ¡å®Œæˆç‡ | 65% | 85% | â¬†ï¸ 31% |

**æŠ•å…¥1å‘¨ï¼ŒèŠ‚çœé•¿æœŸæˆæœ¬60%ï¼Œå€¼å¾—ï¼** ğŸ’°ğŸš€

