# æ‰˜ç®¡æ¨¡å¼ï¼šè‡ªä¸»ä»»åŠ¡ç”Ÿæˆä¸æ‰§è¡Œæ–¹æ¡ˆ

> åˆ›å»ºæ—¶é—´ï¼š2025-10-26 19:10  
> çŠ¶æ€ï¼šæ¦‚å¿µè®¾è®¡  
> ä¼˜å…ˆçº§ï¼šP2ï¼ˆåˆ›æ–°æ¢ç´¢ï¼‰  
> å®æ–½å‘¨æœŸï¼š1-2å‘¨  
> é£é™©ç­‰çº§ï¼šâš ï¸ ä¸­é«˜ï¼ˆéœ€è¦ä¸¥æ ¼å®‰å…¨æ§åˆ¶ï¼‰

---

## ğŸŒŸ æ ¸å¿ƒç†å¿µ

**è®©Agentè‡ªä¸»è¯†åˆ«å½“å‰å·¥ä½œæ¨¡å¼ï¼Œç”Ÿæˆç›¸å…³ä»»åŠ¡å¹¶è‡ªåŠ¨æ‰§è¡Œï¼Œç”¨æˆ·æ— éœ€å¹²é¢„ã€‚**

### å…¸å‹åœºæ™¯

```
åœºæ™¯ï¼šç”¨æˆ·æ­£åœ¨è®©Agentå†™æ–¹æ¡ˆæ–‡æ¡£

19:00 ç”¨æˆ·ï¼š"å¸®æˆ‘å†™3ä¸ªæ–¹æ¡ˆæ–‡æ¡£"
   â†“
19:30 Agentå®Œæˆ3ä¸ªæ–‡æ¡£
   â†“
19:31 ç”¨æˆ·ï¼š"å¼€å¯æ‰˜ç®¡æ¨¡å¼ï¼Œç»§ç»­ç”Ÿæˆç›¸å…³æ–¹æ¡ˆ"
   â†“
ã€æ‰˜ç®¡æ¨¡å¼å¯åŠ¨ã€‘
   â†“
19:35 Agentè‡ªä¸»ç”Ÿæˆï¼š"APIç›‘æ§æ–¹æ¡ˆ"
19:40 Agentè‡ªä¸»ç”Ÿæˆï¼š"æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ"
19:45 Agentè‡ªä¸»ç”Ÿæˆï¼š"å®‰å…¨é˜²æŠ¤æ–¹æ¡ˆ"
...ï¼ˆæŒç»­åˆ°ç”¨æˆ·è®¾å®šçš„æ—¶é—´æˆ–ä»»åŠ¡æ•°ï¼‰
   â†“
07:00 ç”¨æˆ·é†’æ¥
   â†“
æŸ¥çœ‹ç”Ÿæˆçš„50ä¸ªæ–¹æ¡ˆï¼Œç­›é€‰å‡º20ä¸ªæœ‰ä»·å€¼çš„
   â†“
å¼€å§‹æ‰§è¡Œ
```

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### åŒAgentæ¶æ„ï¼ˆå…³é”®åˆ›æ–°ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‰˜ç®¡Agent (Autonomous Agent)                           â”‚
â”‚  è§’è‰²ï¼šç®¡ç†è€…/è§„åˆ’è€…                                     â”‚
â”‚  èƒ½åŠ›ï¼šåªèƒ½å‘é€è¯·æ±‚å’Œè¯„ä¼°ï¼Œä¸èƒ½ç›´æ¥æ“ä½œæ–‡ä»¶              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”§ ä¸“å±å·¥å…·é›†ï¼š                                         â”‚
â”‚  1. send_request      - å‘æ‰§è¡ŒAgentå‘é€ä»»åŠ¡è¯·æ±‚          â”‚
â”‚  2. judge_result      - è¯„ä¼°æ‰§è¡ŒAgentçš„ç»“æœè´¨é‡          â”‚
â”‚  3. generate_tasks    - ç”Ÿæˆæ–°ä»»åŠ¡å€™é€‰åˆ—è¡¨               â”‚
â”‚  4. adjust_strategy   - è°ƒæ•´ä»»åŠ¡ç”Ÿæˆç­–ç•¥                 â”‚
â”‚  5. review_batch      - æ‰¹é‡å®¡æŸ¥å·²å®Œæˆä»»åŠ¡               â”‚
â”‚  6. detect_pattern    - é‡æ–°åˆ†æå·¥ä½œæ¨¡å¼                 â”‚
â”‚  7. pause_autonomous  - æš‚åœæ‰˜ç®¡æ¨¡å¼                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“ send_request
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‰§è¡ŒAgent (Execution Agent)                            â”‚
â”‚  è§’è‰²ï¼šæ‰§è¡Œè€…/å·¥ä½œè€…                                     â”‚
â”‚  èƒ½åŠ›ï¼šæ–‡ä»¶æ“ä½œã€ä»£ç æœç´¢ã€ç»ˆç«¯å‘½ä»¤ç­‰å…¨éƒ¨å®é™…æ“ä½œ         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”§ å·¥å…·é›†ï¼š                                            â”‚
â”‚  read_file, write_file, edit_file, list_files,         â”‚
â”‚  search_code, run_terminal, etc.                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“ æ‰§è¡Œç»“æœ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç»“æœå­˜å‚¨ä¸è´¨é‡è¯„ä¼°                                      â”‚
â”‚  - ä¿å­˜æ‰€æœ‰ç”Ÿæˆçš„æ–‡ä»¶/ç»“æœ                               â”‚
â”‚  - è´¨é‡è¯„åˆ†å’Œåˆ†ç±»                                        â”‚
â”‚  - ç”¨æˆ·å®¡æ ¸é˜Ÿåˆ—                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¶æ„ä¼˜åŠ¿

**ä¸ºä»€ä¹ˆè¦åˆ†ç¦»ä¸¤ä¸ªAgentï¼Ÿ**

1. **å®‰å…¨éš”ç¦»**
   - æ‰˜ç®¡Agentåªèƒ½"è§„åˆ’"ï¼Œä¸èƒ½"æ‰§è¡Œ"
   - é˜²æ­¢è‡ªä¸»æ¨¡å¼ä¸‹çš„å±é™©æ“ä½œ
   - æ‰€æœ‰å®é™…æ“ä½œç”±æ‰§è¡ŒAgentå®Œæˆï¼Œå¯å®¡è®¡

2. **èŒè´£æ¸…æ™°**
   - æ‰˜ç®¡Agentï¼šæƒ³ä»»åŠ¡ã€è¯„è´¨é‡ã€è°ƒç­–ç•¥
   - æ‰§è¡ŒAgentï¼šå¹²æ´»ã€æŠ¥å‘Šç»“æœ
   - ä¸ä¼šæ··ä¹±

3. **å¹¶å‘æ‰§è¡Œ**
   - æ‰˜ç®¡Agentç”Ÿæˆä¸‹ä¸€æ‰¹ä»»åŠ¡
   - æ‰§è¡ŒAgentæ‰§è¡Œå½“å‰æ‰¹æ¬¡
   - æµæ°´çº¿å¹¶è¡Œ

---

### ä¸‰å¤§æ ¸å¿ƒæ¨¡å—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1ï¸âƒ£ å·¥ä½œæ¨¡å¼è¯†åˆ«å™¨                       â”‚
â”‚    Pattern Recognizer                   â”‚
â”‚    - åˆ†ææœ€è¿‘å¯¹è¯                        â”‚
â”‚    - è¯†åˆ«é‡å¤æ¨¡å¼                        â”‚
â”‚    - æå–å·¥ä½œä¸»é¢˜                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2ï¸âƒ£ è‡ªä¸»ä»»åŠ¡ç”Ÿæˆå™¨                       â”‚
â”‚    Autonomous Task Generator            â”‚
â”‚    - åŸºäºæ¨¡å¼ç”Ÿæˆæ–°ä»»åŠ¡                   â”‚
â”‚    - è¯„ä¼°ä»»åŠ¡ç›¸å…³æ€§                      â”‚
â”‚    - æ§åˆ¶ç”Ÿæˆæ•°é‡                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3ï¸âƒ£ è‡ªåŠ¨æ‰§è¡Œå¼•æ“                         â”‚
â”‚    Auto Execution Engine                â”‚
â”‚    - æ‰¹é‡æ‰§è¡Œä»»åŠ¡                        â”‚
â”‚    - ç»“æœè´¨é‡è¯„ä¼°                        â”‚
â”‚    - å®‰å…¨è¾¹ç•Œæ§åˆ¶                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ æ‰˜ç®¡Agentä¸“å±å·¥å…·è¯¦è§£

### å·¥å…·1: send_requestï¼ˆå‘é€ä»»åŠ¡è¯·æ±‚ï¼‰

```python
{
    "name": "send_request",
    "description": "å‘æ‰§è¡ŒAgentå‘é€ä»»åŠ¡è¯·æ±‚ï¼Œæ‰§è¡ŒAgentä¼šå®é™…æ‰§è¡Œæ–‡ä»¶æ“ä½œç­‰ä»»åŠ¡",
    "parameters": {
        "type": "object",
        "properties": {
            "request_title": {
                "type": "string",
                "description": "ä»»åŠ¡æ ‡é¢˜"
            },
            "request_content": {
                "type": "string",
                "description": "è¯¦ç»†çš„ä»»åŠ¡æè¿°ï¼Œå°†ä½œä¸ºç”¨æˆ·æ¶ˆæ¯å‘é€ç»™æ‰§è¡ŒAgent"
            },
            "priority": {
                "type": "integer",
                "description": "ä¼˜å…ˆçº§(1-10)ï¼Œé«˜ä¼˜å…ˆçº§ä¼˜å…ˆæ‰§è¡Œ",
                "minimum": 1,
                "maximum": 10
            },
            "expected_output": {
                "type": "string",
                "description": "æœŸæœ›çš„è¾“å‡ºç±»å‹ï¼ˆæ–‡ä»¶/æŠ¥å‘Š/ä»£ç ç­‰ï¼‰"
            },
            "metadata": {
                "type": "object",
                "description": "é™„åŠ å…ƒæ•°æ®ï¼ˆå¦‚é¢„ä¼°è€—æ—¶ã€ç›¸å…³ä»»åŠ¡ç­‰ï¼‰"
            }
        },
        "required": ["request_title", "request_content"]
    }
}

# ç¤ºä¾‹è°ƒç”¨
{
    "request_title": "ç¼–å†™APIç›‘æ§æ–¹æ¡ˆæ–‡æ¡£",
    "request_content": "è¯·ç¼–å†™ä¸€ä¸ªè¯¦ç»†çš„APIç›‘æ§æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ï¼šç›‘æ§æŒ‡æ ‡è®¾è®¡ã€å®æ—¶å‘Šè­¦æœºåˆ¶ã€æ€§èƒ½åˆ†æå·¥å…·ç­‰å†…å®¹ï¼Œä¿å­˜åˆ° docs/about2Do/ ç›®å½•",
    "priority": 8,
    "expected_output": "markdownæ–‡æ¡£",
    "metadata": {
        "estimated_time": 120,
        "related_to": ["APIæ—¥å¿—æ–¹æ¡ˆ", "æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ"]
    }
}
```

**æ‰§è¡Œæµç¨‹**ï¼š
```
æ‰˜ç®¡Agentè°ƒç”¨send_request
   â†“
ä»»åŠ¡è¿›å…¥æ‰§è¡Œé˜Ÿåˆ—
   â†“
æ‰§è¡ŒAgentæ‹¿åˆ°ä»»åŠ¡
   â†“
æ‰§è¡ŒAgentè°ƒç”¨å®é™…å·¥å…·(write_fileç­‰)
   â†“
è¿”å›ç»“æœç»™æ‰˜ç®¡Agent
```

---

### å·¥å…·2: judge_resultï¼ˆè¯„ä¼°ç»“æœè´¨é‡ï¼‰

```python
{
    "name": "judge_result",
    "description": "è¯„ä¼°æ‰§è¡ŒAgentå®Œæˆçš„ä»»åŠ¡è´¨é‡ï¼Œåˆ¤æ–­æ˜¯å¦è¾¾æ ‡ã€æ˜¯å¦éœ€è¦é‡åš",
    "parameters": {
        "type": "object",
        "properties": {
            "task_id": {
                "type": "string",
                "description": "è¦è¯„ä¼°çš„ä»»åŠ¡ID"
            },
            "result_content": {
                "type": "string",
                "description": "ä»»åŠ¡æ‰§è¡Œç»“æœå†…å®¹"
            },
            "evaluation_criteria": {
                "type": "array",
                "items": {"type": "string"},
                "description": "è¯„ä¼°æ ‡å‡†åˆ—è¡¨"
            },
            "quality_score": {
                "type": "number",
                "description": "è´¨é‡è¯„åˆ†(0-10)",
                "minimum": 0,
                "maximum": 10
            },
            "pass": {
                "type": "boolean",
                "description": "æ˜¯å¦é€šè¿‡è´¨é‡æ£€æŸ¥"
            },
            "feedback": {
                "type": "string",
                "description": "æ”¹è¿›å»ºè®®ï¼ˆå¦‚æœä¸é€šè¿‡ï¼‰"
            },
            "needs_revision": {
                "type": "boolean",
                "description": "æ˜¯å¦éœ€è¦é‡æ–°æ‰§è¡Œ"
            }
        },
        "required": ["task_id", "quality_score", "pass"]
    }
}

# ç¤ºä¾‹è°ƒç”¨
{
    "task_id": "task_047",
    "result_content": "...(æ–¹æ¡ˆæ–‡æ¡£å†…å®¹)...",
    "evaluation_criteria": [
        "ç»“æ„å®Œæ•´æ€§",
        "æŠ€æœ¯å¯è¡Œæ€§",
        "å†…å®¹è¯¦å®åº¦",
        "åˆ›æ–°æ€§"
    ],
    "quality_score": 8.5,
    "pass": true,
    "feedback": "æ–¹æ¡ˆè´¨é‡ä¼˜ç§€ï¼Œå»ºè®®å®æ–½",
    "needs_revision": false
}
```

---

### å·¥å…·3: generate_tasksï¼ˆç”Ÿæˆä»»åŠ¡å€™é€‰ï¼‰

```python
{
    "name": "generate_tasks",
    "description": "åŸºäºå½“å‰å·¥ä½œæ¨¡å¼ç”Ÿæˆæ–°çš„ä»»åŠ¡å€™é€‰åˆ—è¡¨ï¼Œä¸ç›´æ¥æ‰§è¡Œï¼Œåªæ˜¯ç”Ÿæˆå€™é€‰",
    "parameters": {
        "type": "object",
        "properties": {
            "base_theme": {
                "type": "string",
                "description": "åŸºç¡€ä¸»é¢˜"
            },
            "generation_strategy": {
                "type": "string",
                "enum": ["direct_variants", "lateral_expansion", "deep_dive", "innovative"],
                "description": "ç”Ÿæˆç­–ç•¥ï¼šç›´æ¥å˜ä½“/æ¨ªå‘æ‰©å±•/æ·±åº¦æŒ–æ˜/åˆ›æ–°æ¢ç´¢"
            },
            "count": {
                "type": "integer",
                "description": "ç”Ÿæˆæ•°é‡",
                "minimum": 1,
                "maximum": 20
            },
            "avoid_topics": {
                "type": "array",
                "items": {"type": "string"},
                "description": "è¦é¿å…çš„ä¸»é¢˜ï¼ˆå·²ç”Ÿæˆè¿‡çš„ï¼‰"
            },
            "tasks": {
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "title": {"type": "string"},
                        "description": {"type": "string"},
                        "estimated_value": {"type": "number"},
                        "reasoning": {"type": "string"}
                    }
                },
                "description": "ç”Ÿæˆçš„ä»»åŠ¡åˆ—è¡¨"
            }
        },
        "required": ["base_theme", "tasks"]
    }
}
```

---

### å·¥å…·4: adjust_strategyï¼ˆè°ƒæ•´ç”Ÿæˆç­–ç•¥ï¼‰

```python
{
    "name": "adjust_strategy",
    "description": "æ ¹æ®æ‰§è¡Œåé¦ˆè°ƒæ•´ä»»åŠ¡ç”Ÿæˆç­–ç•¥ï¼Œä¼˜åŒ–åç»­ä»»åŠ¡çš„è´¨é‡å’Œç›¸å…³æ€§",
    "parameters": {
        "type": "object",
        "properties": {
            "current_quality_trend": {
                "type": "string",
                "enum": ["improving", "stable", "declining"],
                "description": "å½“å‰è´¨é‡è¶‹åŠ¿"
            },
            "adjustment_reason": {
                "type": "string",
                "description": "è°ƒæ•´åŸå› "
            },
            "new_strategy": {
                "type": "object",
                "properties": {
                    "focus_areas": {
                        "type": "array",
                        "items": {"type": "string"},
                        "description": "æ–°çš„èšç„¦é¢†åŸŸ"
                    },
                    "generation_rate": {
                        "type": "string",
                        "enum": ["slower", "normal", "faster"],
                        "description": "ç”Ÿæˆé€Ÿåº¦è°ƒæ•´"
                    },
                    "quality_over_quantity": {
                        "type": "boolean",
                        "description": "æ˜¯å¦ä¼˜å…ˆè´¨é‡è€Œéæ•°é‡"
                    }
                }
            }
        },
        "required": ["current_quality_trend", "new_strategy"]
    }
}

# ç¤ºä¾‹ï¼šè´¨é‡ä¸‹é™æ—¶è°ƒæ•´
{
    "current_quality_trend": "declining",
    "adjustment_reason": "æœ€è¿‘5ä¸ªä»»åŠ¡è´¨é‡è¯„åˆ†ä»8.5é™åˆ°6.2ï¼Œå‡ºç°é‡å¤å’Œæ— ä»·å€¼å†…å®¹",
    "new_strategy": {
        "focus_areas": ["æ·±åº¦æŠ€æœ¯æ–¹æ¡ˆ", "åˆ›æ–°æ€§æ¢ç´¢"],
        "generation_rate": "slower",  # æ”¾æ…¢é€Ÿåº¦ï¼Œæé«˜è´¨é‡
        "quality_over_quantity": true
    }
}
```

---

### å·¥å…·5: review_batchï¼ˆæ‰¹é‡å®¡æŸ¥ï¼‰

```python
{
    "name": "review_batch",
    "description": "æ‰¹é‡å®¡æŸ¥æœ€è¿‘å®Œæˆçš„Nä¸ªä»»åŠ¡ï¼Œè¯†åˆ«æ¨¡å¼å’Œé—®é¢˜",
    "parameters": {
        "type": "object",
        "properties": {
            "batch_size": {
                "type": "integer",
                "description": "å®¡æŸ¥æœ€è¿‘å¤šå°‘ä¸ªä»»åŠ¡",
                "minimum": 5,
                "maximum": 20
            },
            "review_summary": {
                "type": "object",
                "properties": {
                    "high_quality_count": {"type": "integer"},
                    "medium_quality_count": {"type": "integer"},
                    "low_quality_count": {"type": "integer"},
                    "duplicate_found": {"type": "boolean"},
                    "pattern_drift": {"type": "boolean"},
                    "recommendations": {
                        "type": "array",
                        "items": {"type": "string"}
                    }
                }
            }
        },
        "required": ["batch_size", "review_summary"]
    }
}

# ç¤ºä¾‹è¾“å‡º
{
    "batch_size": 10,
    "review_summary": {
        "high_quality_count": 7,
        "medium_quality_count": 2,
        "low_quality_count": 1,
        "duplicate_found": true,  # å‘ç°é‡å¤
        "pattern_drift": false,   # æ²¡æœ‰åç¦»ä¸»é¢˜
        "recommendations": [
            "è´¨é‡æ•´ä½“è‰¯å¥½ï¼Œå»ºè®®ç»§ç»­",
            "å‘ç°2ä¸ªé‡å¤ä¸»é¢˜ï¼Œå»ºè®®å¢å¼ºå»é‡",
            "å¯ä»¥å°è¯•æ›´åˆ›æ–°çš„æ–¹å‘"
        ]
    }
}
```

---

### å·¥å…·6: detect_patternï¼ˆé‡æ–°è¯†åˆ«æ¨¡å¼ï¼‰

```python
{
    "name": "detect_pattern",
    "description": "é‡æ–°åˆ†æå½“å‰çš„å·¥ä½œæ¨¡å¼ï¼Œé€‚åº”ä»»åŠ¡æ¼”å˜",
    "parameters": {
        "type": "object",
        "properties": {
            "trigger_reason": {
                "type": "string",
                "description": "ä¸ºä»€ä¹ˆè¦é‡æ–°è¯†åˆ«"
            },
            "new_pattern": {
                "type": "object",
                "properties": {
                    "pattern_type": {"type": "string"},
                    "ä¸»é¢˜": {"type": "string"},
                    "theme_evolution": {"type": "string"},
                    "confidence": {"type": "number"}
                }
            },
            "should_continue": {
                "type": "boolean",
                "description": "æ˜¯å¦åº”è¯¥ç»§ç»­å½“å‰æ–¹å‘"
            }
        },
        "required": ["new_pattern", "should_continue"]
    }
}

# ä½¿ç”¨åœºæ™¯ï¼š
# æ‰§è¡Œäº†20ä¸ªä»»åŠ¡åï¼Œé‡æ–°åˆ†ææ˜¯å¦è¿˜åœ¨æ­£ç¡®çš„æ–¹å‘ä¸Š
```

---

### å·¥å…·7: pause_autonomousï¼ˆæš‚åœæ§åˆ¶ï¼‰

```python
{
    "name": "pause_autonomous",
    "description": "æš‚åœæ‰˜ç®¡æ¨¡å¼ï¼Œç­‰å¾…ç”¨æˆ·ä»‹å…¥",
    "parameters": {
        "type": "object",
        "properties": {
            "reason": {
                "type": "string",
                "enum": [
                    "quality_declining",
                    "cost_threshold",
                    "need_user_input",
                    "pattern_unclear",
                    "safety_concern"
                ],
                "description": "æš‚åœåŸå› "
            },
            "message_to_user": {
                "type": "string",
                "description": "ç»™ç”¨æˆ·çš„è¯´æ˜"
            },
            "current_progress": {
                "type": "object",
                "description": "å½“å‰è¿›åº¦æ‘˜è¦"
            },
            "resume_suggestion": {
                "type": "string",
                "description": "å»ºè®®å¦‚ä½•æ¢å¤"
            }
        },
        "required": ["reason", "message_to_user"]
    }
}

# ç¤ºä¾‹ï¼šè´¨é‡ä¸‹é™æ—¶ä¸»åŠ¨æš‚åœ
{
    "reason": "quality_declining",
    "message_to_user": "å·²å®Œæˆ30ä¸ªä»»åŠ¡ï¼Œä½†æœ€è¿‘5ä¸ªè´¨é‡æŒç»­ä¸‹é™(å¹³å‡6.1åˆ†)ï¼Œå»ºè®®æš‚åœå¹¶äººå·¥å®¡æŸ¥",
    "current_progress": {
        "completed": 30,
        "high_quality": 22,
        "needs_review": 8
    },
    "resume_suggestion": "å®¡æŸ¥åå¯è°ƒæ•´ç”Ÿæˆç­–ç•¥å¹¶ç»§ç»­"
}
```

---

## ğŸ”„ æ‰˜ç®¡Agentå®Œæ•´æ‰§è¡Œæµç¨‹

### ä¸»å¾ªç¯

```python
# core/autonomous_agent.py

class AutonomousAgent:
    """æ‰˜ç®¡Agentï¼ˆåªèƒ½è§„åˆ’å’Œè¯„ä¼°ï¼Œä¸èƒ½ç›´æ¥æ“ä½œï¼‰"""
    
    def __init__(self, execution_agent: Agent):
        """
        åˆå§‹åŒ–æ‰˜ç®¡Agent
        
        Args:
            execution_agent: æ‰§è¡ŒAgentå®ä¾‹ï¼ˆè´Ÿè´£å®é™…æ“ä½œï¼‰
        """
        self.execution_agent = execution_agent
        self.llm_service = get_llm_service()  # æ‰˜ç®¡Agentæœ‰è‡ªå·±çš„LLM
        
        # æ‰˜ç®¡Agentçš„ä¸“å±å·¥å…·
        self.tools = self._register_autonomous_tools()
    
    def _register_autonomous_tools(self):
        """æ³¨å†Œæ‰˜ç®¡Agentä¸“å±å·¥å…·"""
        return [
            self._build_send_request_tool(),
            self._build_judge_result_tool(),
            self._build_generate_tasks_tool(),
            self._build_adjust_strategy_tool(),
            self._build_review_batch_tool(),
            self._build_detect_pattern_tool(),
            self._build_pause_autonomous_tool()
        ]
    
    async def run_autonomous_loop(self, initial_pattern: Dict, config: Dict):
        """æ‰˜ç®¡æ¨¡å¼ä¸»å¾ªç¯"""
        
        messages = [
            {
                "role": "system",
                "content": AUTONOMOUS_AGENT_PROMPT  # æ‰˜ç®¡Agentä¸“ç”¨Prompt
            },
            {
                "role": "user",
                "content": f"""ä½ ç°åœ¨æ˜¯æ‰˜ç®¡ç®¡ç†è€…ã€‚

è¯†åˆ«åˆ°çš„å·¥ä½œæ¨¡å¼ï¼š
{json.dumps(initial_pattern, ensure_ascii=False, indent=2)}

ä½ çš„ä»»åŠ¡ï¼š
1. åŸºäºè¿™ä¸ªæ¨¡å¼æŒç»­ç”Ÿæˆç›¸å…³ä»»åŠ¡
2. è°ƒç”¨send_requestå‘é€ç»™æ‰§è¡ŒAgent
3. ç”¨judge_resultè¯„ä¼°æ‰§è¡Œç»“æœ
4. æ ¹æ®è´¨é‡è°ƒæ•´ç­–ç•¥
5. è¾¾åˆ°åœæ­¢æ¡ä»¶æ—¶è‡ªåŠ¨ç»“æŸ

é…ç½®ï¼š
- æœ€å¤š{config['max_tasks']}ä¸ªä»»åŠ¡
- æœ€å¤šè¿è¡Œ{config['max_hours']}å°æ—¶
- æˆæœ¬ä¸Šé™Â¥{config['max_cost']}

å¼€å§‹å·¥ä½œå§ï¼"""
            }
        ]
        
        task_queue = []
        executed_count = 0
        
        # ========== æ‰˜ç®¡Agentçš„è¿­ä»£å¾ªç¯ ==========
        while executed_count < config['max_tasks']:
            
            # è°ƒç”¨æ‰˜ç®¡Agentï¼ˆå®ƒä¼šå†³å®šä¸‹ä¸€æ­¥åšä»€ä¹ˆï¼‰
            response = self.llm_service.chat(
                messages=messages,
                tools=self.tools,
                tool_choice="auto"  # è®©æ‰˜ç®¡Agentè‡ªå·±å†³å®š
            )
            
            # å¤„ç†å·¥å…·è°ƒç”¨
            if response.get("tool_calls"):
                for tool_call in response["tool_calls"]:
                    tool_name = tool_call["function"]["name"]
                    arguments = json.loads(tool_call["function"]["arguments"])
                    
                    # ========== å¤„ç†ä¸åŒå·¥å…· ==========
                    
                    if tool_name == "send_request":
                        # å‘é€ä»»åŠ¡ç»™æ‰§è¡ŒAgent
                        task_result = await self._handle_send_request(arguments)
                        executed_count += 1
                        
                        # è¿”å›ç»“æœç»™æ‰˜ç®¡Agent
                        messages.append({
                            "role": "tool",
                            "content": json.dumps(task_result, ensure_ascii=False)
                        })
                    
                    elif tool_name == "judge_result":
                        # è¯„ä¼°å·²å®Œæˆçš„ä»»åŠ¡
                        # (æ‰˜ç®¡Agentè‡ªå·±åšè¯„ä¼°åˆ¤æ–­)
                        judgment = arguments  # æ‰˜ç®¡Agentçš„åˆ¤æ–­
                        self._record_judgment(judgment)
                    
                    elif tool_name == "generate_tasks":
                        # ç”Ÿæˆæ–°ä»»åŠ¡å€™é€‰
                        new_tasks = arguments["tasks"]
                        task_queue.extend(new_tasks)
                    
                    elif tool_name == "adjust_strategy":
                        # è°ƒæ•´ç­–ç•¥
                        self._apply_strategy_adjustment(arguments)
                    
                    elif tool_name == "review_batch":
                        # æ‰¹é‡å®¡æŸ¥
                        review = arguments["review_summary"]
                        self._process_review(review)
                    
                    elif tool_name == "detect_pattern":
                        # é‡æ–°è¯†åˆ«æ¨¡å¼
                        new_pattern = arguments["new_pattern"]
                        if not arguments["should_continue"]:
                            print("[Autonomous] æ¨¡å¼è¯†åˆ«å»ºè®®åœæ­¢")
                            break
                    
                    elif tool_name == "pause_autonomous":
                        # æ‰˜ç®¡Agentä¸»åŠ¨æš‚åœ
                        print(f"[Autonomous] ä¸»åŠ¨æš‚åœ: {arguments['reason']}")
                        return self._generate_pause_report(arguments)
            
            else:
                # æ‰˜ç®¡Agentè¿”å›çº¯æ–‡æœ¬ï¼ˆå¯èƒ½æ˜¯æ€»ç»“ï¼‰
                print(f"[Autonomous] Agentæ¶ˆæ¯: {response.get('content')}")
        
        # ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š
        return self._generate_final_report()
    
    async def _handle_send_request(self, request: Dict) -> Dict:
        """å¤„ç†send_requestå·¥å…·è°ƒç”¨"""
        
        print(f"\n[Autonomousâ†’Execution] å‘é€ä»»åŠ¡: {request['request_title']}")
        
        # è°ƒç”¨æ‰§è¡ŒAgent
        execution_result = await self.execution_agent.run(
            user_message=request["request_content"],
            context_history=[]  # ç‹¬ç«‹Context
        )
        
        # åŒ…è£…è¿”å›ç»“æœ
        return {
            "task_title": request["request_title"],
            "success": execution_result.get("success", False),
            "result_summary": execution_result.get("message", "")[:200],
            "tokens_used": execution_result.get("token_usage", {}).get("total_tokens", 0),
            "estimated_cost": self._estimate_cost(execution_result)
        }
```

---

## ğŸ¨ æ‰˜ç®¡Agentçš„System Prompt

```python
AUTONOMOUS_AGENT_PROMPT = """ä½ æ˜¯æ‰˜ç®¡æ¨¡å¼çš„ç®¡ç†Agentï¼Œè´Ÿè´£è‡ªä¸»ç”Ÿæˆå’Œç®¡ç†ä»»åŠ¡ã€‚

ä½ çš„è§’è‰²ï¼š
- ä½ æ˜¯ç®¡ç†è€…ï¼Œä¸æ˜¯æ‰§è¡Œè€…
- ä½ åªèƒ½é€šè¿‡å·¥å…·ä¸æ‰§è¡ŒAgentäº¤äº’
- ä½ ä¸èƒ½ç›´æ¥æ“ä½œæ–‡ä»¶ã€ä»£ç ç­‰

ä½ çš„å·¥å…·ï¼š
1. send_request: å‘é€ä»»åŠ¡ç»™æ‰§è¡ŒAgent
2. judge_result: è¯„ä¼°æ‰§è¡Œç»“æœè´¨é‡
3. generate_tasks: ç”Ÿæˆæ–°ä»»åŠ¡å€™é€‰
4. adjust_strategy: è°ƒæ•´ç”Ÿæˆç­–ç•¥
5. review_batch: æ‰¹é‡å®¡æŸ¥ä»»åŠ¡
6. detect_pattern: é‡æ–°è¯†åˆ«å·¥ä½œæ¨¡å¼
7. pause_autonomous: ä¸»åŠ¨æš‚åœï¼ˆé‡åˆ°é—®é¢˜æ—¶ï¼‰

å·¥ä½œæµç¨‹ï¼š
1. åŸºäºå·¥ä½œæ¨¡å¼ï¼Œè°ƒç”¨generate_tasksç”Ÿæˆ5-10ä¸ªå€™é€‰ä»»åŠ¡
2. é€‰æ‹©é«˜ä»·å€¼çš„ä»»åŠ¡ï¼Œç”¨send_requestå‘é€ç»™æ‰§è¡ŒAgent
3. æ”¶åˆ°ç»“æœåï¼Œç”¨judge_resultè¯„ä¼°è´¨é‡
4. æ¯å®Œæˆ10ä¸ªä»»åŠ¡ï¼Œç”¨review_batchæ‰¹é‡å®¡æŸ¥
5. æ ¹æ®å®¡æŸ¥ç»“æœï¼Œç”¨adjust_strategyè°ƒæ•´ç­–ç•¥
6. å¦‚æœè´¨é‡æŒç»­ä¸‹é™æˆ–åç¦»ä¸»é¢˜ï¼Œç”¨detect_patterné‡æ–°è¯†åˆ«
7. é‡åˆ°å¼‚å¸¸æƒ…å†µï¼Œç”¨pause_autonomousæš‚åœå¹¶é€šçŸ¥ç”¨æˆ·

âš ï¸âš ï¸âš ï¸ æœ€é‡è¦çš„è§„åˆ™ï¼šå¼ºè®°å¿†ç”¨æˆ·æ–¹å‘ âš ï¸âš ï¸âš ï¸

ç”¨æˆ·åœ¨æ‰˜ç®¡æ¨¡å¼å¯åŠ¨å‰ç»™ä½ çš„ã€æ ¸å¿ƒæ–¹å‘ã€‘æ˜¯ä½ çš„"åŒ—ææ˜Ÿ"ï¼Œå¿…é¡»ï¼š

1. æ¯æ¬¡ç”Ÿæˆä»»åŠ¡å‰ï¼Œå…ˆå›é¡¾ã€æ ¸å¿ƒæ–¹å‘ã€‘
2. æ¯ä¸ªä»»åŠ¡å¿…é¡»ä¸ã€æ ¸å¿ƒæ–¹å‘ã€‘å¼ºç›¸å…³
3. æ¯10ä¸ªä»»åŠ¡ï¼Œæ£€æŸ¥æ˜¯å¦åç¦»ã€æ ¸å¿ƒæ–¹å‘ã€‘
4. å‘ç°åç¦»ç«‹å³çº æ­£ï¼Œä¸è¦ç»§ç»­

ç¤ºä¾‹ï¼š
ã€æ ¸å¿ƒæ–¹å‘ã€‘ï¼š"ç¼–å†™Agentä¼˜åŒ–æ”¹è¿›æ–¹æ¡ˆæ–‡æ¡£"

âœ… æ­£ç¡®ä»»åŠ¡ï¼š
  - "Contextå‹ç¼©ä¼˜åŒ–æ–¹æ¡ˆ"
  - "å·¥å…·è°ƒç”¨æ§åˆ¶æ–¹æ¡ˆ"
  - "æˆæœ¬æ§åˆ¶æ–¹æ¡ˆ"
  â†’ éƒ½æ˜¯"Agentä¼˜åŒ–"ç›¸å…³

âŒ é”™è¯¯ä»»åŠ¡ï¼ˆåç¦»æ–¹å‘ï¼‰ï¼š
  - "å‰ç«¯UIç¾åŒ–æ–¹æ¡ˆ" â† åç¦»äº†ï¼ˆä¸æ˜¯Agentä¼˜åŒ–ï¼‰
  - "æ•°æ®åº“è®¾è®¡æ–¹æ¡ˆ" â† åç¦»äº†
  - "ç”¨æˆ·æƒé™æ–¹æ¡ˆ" â† åç¦»äº†
  â†’ åº”è¯¥ç«‹å³åœæ­¢å¹¶çº æ­£

è®°å¿†å£è¯€ï¼š
  "æ¯ç”Ÿæˆä¸€ä¸ªä»»åŠ¡ï¼Œé—®è‡ªå·±ï¼šè¿™ç¬¦åˆã€æ ¸å¿ƒæ–¹å‘ã€‘å—ï¼Ÿ"
  "ä¸ç¬¦åˆ = ä¸ç”Ÿæˆï¼"

æ³¨æ„äº‹é¡¹ï¼š
âš ï¸ ä½ ä¸èƒ½ç›´æ¥æ“ä½œæ–‡ä»¶ï¼åªèƒ½é€šè¿‡send_requestè®©æ‰§è¡ŒAgentå»åš
âš ï¸ ä¿æŒä»»åŠ¡ä¸ã€æ ¸å¿ƒæ–¹å‘ã€‘çš„å¼ºç›¸å…³æ€§ï¼ˆæœ€é‡è¦ï¼ï¼‰
âš ï¸ é¿å…ç”Ÿæˆé‡å¤ä»»åŠ¡
âš ï¸ è´¨é‡ä¼˜å…ˆäºæ•°é‡
âš ï¸ å‘ç°åç¦»æ–¹å‘ç«‹å³æš‚åœå¹¶çº æ­£

ä½ çš„ç›®æ ‡ï¼šåœ¨ç”¨æˆ·ä¼‘æ¯æ—¶ï¼Œé«˜æ•ˆåœ°ç”Ÿæˆå¤§é‡é«˜è´¨é‡ä¸”ã€ç¬¦åˆæ ¸å¿ƒæ–¹å‘ã€‘çš„ä»»åŠ¡æˆæœã€‚
"""
```

---

## ğŸ§­ æ ¸å¿ƒæœºåˆ¶ï¼šæ–¹å‘é”šå®šä¸åç¦»é˜²æŠ¤ï¼ˆæœ€é‡è¦ï¼ï¼‰

### é—®é¢˜ï¼šæ–¹å‘æ¼‚ç§»

```
ç”¨æˆ·ç¡å‰ï¼ˆ19:00ï¼‰ï¼š"å†™Agentä¼˜åŒ–æ–¹æ¡ˆ"
   â†“
æ‰˜ç®¡Agentå¼€å§‹å·¥ä½œ
   â†“
20:00 ç”Ÿæˆï¼š"Contextç®¡ç†æ–¹æ¡ˆ" âœ… æ­£ç¡®
21:00 ç”Ÿæˆï¼š"å·¥å…·è°ƒç”¨ä¼˜åŒ–æ–¹æ¡ˆ" âœ… æ­£ç¡®
22:00 ç”Ÿæˆï¼š"æ€§èƒ½ç›‘æ§æ–¹æ¡ˆ" âœ… æ­£ç¡®
23:00 ç”Ÿæˆï¼š"å‰ç«¯UIä¼˜åŒ–æ–¹æ¡ˆ" âš ï¸ å¼€å§‹åç¦»
00:00 ç”Ÿæˆï¼š"æ•°æ®åº“è®¾è®¡æ–¹æ¡ˆ" âŒ å®Œå…¨åç¦»
01:00 ç”Ÿæˆï¼š"ç”¨æˆ·æƒé™æ–¹æ¡ˆ" âŒ è·‘é¢˜äº†
   â†“
ç”¨æˆ·é†’æ¥ï¼ˆ07:00ï¼‰ï¼šğŸ˜¤ "æˆ‘è¦çš„æ˜¯Agentä¼˜åŒ–ï¼Œä½ å†™çš„éƒ½æ˜¯å•¥ï¼Ÿ"
```

**æ ¹å› åˆ†æ**ï¼š
1. Contextç´¯ç§¯ â†’ æ—©æœŸçš„"æ ¸å¿ƒæ–¹å‘"è¢«æŒ¤åˆ°åé¢
2. ç”Ÿæˆæƒ¯æ€§ â†’ é¡ºç€æœ€è¿‘çš„è¯é¢˜ç»§ç»­ï¼Œå¿˜è®°æœ€åˆç›®æ ‡
3. ç¼ºä¹é”šç‚¹ â†’ æ²¡æœ‰å®šæœŸå›é¡¾åŸå§‹æ–¹å‘

---

### è§£å†³æ–¹æ¡ˆï¼šæ–¹å‘é”šå®šç³»ç»Ÿ

#### 1ï¸âƒ£ æ ¸å¿ƒæ–¹å‘å¸¸é©»ï¼ˆAnchor Messageï¼‰

```python
# ç”¨æˆ·å¯åŠ¨æ‰˜ç®¡æ¨¡å¼æ—¶çš„è¾“å…¥
user_direction = "ç¼–å†™Agentä¼˜åŒ–å’Œæ”¹è¿›ç›¸å…³çš„æ–¹æ¡ˆæ–‡æ¡£"

# æ„å»ºé”šç‚¹æ¶ˆæ¯ï¼ˆæ°¸è¿œåœ¨Contextæœ€å‰é¢ï¼‰
DIRECTION_ANCHOR = {
    "role": "system",
    "content": f"""ğŸ¯ğŸ¯ğŸ¯ æ ¸å¿ƒæ–¹å‘ï¼ˆæ°¸è¿œè®°ä½ï¼‰ğŸ¯ğŸ¯ğŸ¯

ç”¨æˆ·åœ¨å¯åŠ¨æ‰˜ç®¡æ¨¡å¼å‰ç»™å‡ºçš„æ ¸å¿ƒæ–¹å‘ï¼š
ã€{user_direction}ã€‘

è¿™æ˜¯ä½ çš„"åŒ—ææ˜Ÿ"ï¼
- æ¯ç”Ÿæˆä¸€ä¸ªä»»åŠ¡å‰ï¼Œå…ˆé—®ï¼šç¬¦åˆè¿™ä¸ªæ–¹å‘å—ï¼Ÿ
- æ¯10ä¸ªä»»åŠ¡ï¼Œå›é¡¾ä¸€æ¬¡è¿™ä¸ªæ–¹å‘
- å‘ç°åç¦»ï¼Œç«‹å³åœæ­¢å¹¶çº æ­£

ä¸ç¬¦åˆã€æ ¸å¿ƒæ–¹å‘ã€‘çš„ä»»åŠ¡ = ä¸è¦ç”Ÿæˆï¼
"""
}

# æ‰˜ç®¡Agentçš„messagesç»“æ„
messages = [
    DIRECTION_ANCHOR,  # â† é”šç‚¹ï¼Œæ°¸è¿œç¬¬ä¸€æ¡
    {"role": "system", "content": AUTONOMOUS_AGENT_PROMPT},
    {"role": "user", "content": "è¯†åˆ«åˆ°çš„å·¥ä½œæ¨¡å¼..."},
    ... # åç»­å¯¹è¯
]

# å…³é”®ï¼šå³ä½¿Contextå‹ç¼©ï¼Œä¹Ÿæ°¸è¿œä¿ç•™DIRECTION_ANCHOR
```

---

#### 2ï¸âƒ£ å®šæœŸæ–¹å‘å›é¡¾ï¼ˆPeriodic Direction Reviewï¼‰

```python
# æ¯Nä¸ªä»»åŠ¡å¼ºåˆ¶å›é¡¾æ–¹å‘
REVIEW_INTERVAL = 10  # æ¯10ä¸ªä»»åŠ¡

if executed_count % REVIEW_INTERVAL == 0:
    # å¼ºåˆ¶æ’å…¥æ–¹å‘å›é¡¾æ¶ˆæ¯
    messages.append({
        "role": "user",
        "content": f"""âš ï¸ å®šæœŸæ–¹å‘æ£€æŸ¥ï¼ˆç¬¬{executed_count}ä¸ªä»»åŠ¡ï¼‰

è¯·å›é¡¾æ ¸å¿ƒæ–¹å‘ï¼šã€{user_direction}ã€‘

æ£€æŸ¥æœ€è¿‘{REVIEW_INTERVAL}ä¸ªä»»åŠ¡ï¼š
{format_recent_tasks(recent_tasks)}

é—®é¢˜ï¼š
1. è¿™äº›ä»»åŠ¡æ˜¯å¦éƒ½ç¬¦åˆæ ¸å¿ƒæ–¹å‘ï¼Ÿ
2. æ˜¯å¦å‡ºç°åç¦»ï¼Ÿ
3. ä¸‹ä¸€æ­¥åº”è¯¥ç»§ç»­è¿˜æ˜¯è°ƒæ•´ï¼Ÿ

è¯·ç”¨detect_patternå·¥å…·åˆ†æï¼Œå¹¶å†³å®šæ˜¯å¦ç»§ç»­ã€‚
"""
    })
```

---

#### 3ï¸âƒ£ å®æ—¶åç¦»æ£€æµ‹ï¼ˆDrift Detectionï¼‰

```python
class DirectionDriftDetector:
    """æ–¹å‘åç¦»æ£€æµ‹å™¨"""
    
    def __init__(self, core_direction: str):
        """
        Args:
            core_direction: ç”¨æˆ·çš„æ ¸å¿ƒæ–¹å‘
        """
        self.core_direction = core_direction
        self.direction_keywords = self._extract_keywords(core_direction)
    
    def _extract_keywords(self, direction: str) -> List[str]:
        """æå–æ ¸å¿ƒæ–¹å‘çš„å…³é”®è¯"""
        # ç¤ºä¾‹ï¼š"ç¼–å†™Agentä¼˜åŒ–æ”¹è¿›æ–¹æ¡ˆæ–‡æ¡£"
        # æå–ï¼š["Agent", "ä¼˜åŒ–", "æ”¹è¿›", "æ–¹æ¡ˆ"]
        
        keywords = []
        # ç§»é™¤åœç”¨è¯
        stopwords = ["çš„", "å’Œ", "ä¸", "ç­‰", "ç¼–å†™", "æ’°å†™"]
        
        for word in direction.split():
            if word not in stopwords and len(word) > 1:
                keywords.append(word)
        
        return keywords
    
    def check_relevance(self, task_title: str, task_description: str) -> Dict:
        """
        æ£€æŸ¥ä»»åŠ¡ä¸æ ¸å¿ƒæ–¹å‘çš„ç›¸å…³æ€§
        
        Returns:
            {
                "relevance_score": 0.85,  # 0-1
                "is_relevant": true,
                "matched_keywords": ["Agent", "ä¼˜åŒ–"],
                "warning": null
            }
        """
        
        # æ–¹æ³•1ï¼šå…³é”®è¯åŒ¹é…
        task_text = (task_title + " " + task_description).lower()
        
        matched = []
        for keyword in self.direction_keywords:
            if keyword.lower() in task_text:
                matched.append(keyword)
        
        keyword_score = len(matched) / len(self.direction_keywords)
        
        # æ–¹æ³•2ï¼šè¯­ä¹‰ç›¸ä¼¼åº¦ï¼ˆå¯é€‰ï¼Œç”¨MiniMaxï¼‰
        semantic_score = self._semantic_similarity(
            self.core_direction,
            task_title
        )
        
        # ç»¼åˆè¯„åˆ†
        relevance_score = keyword_score * 0.4 + semantic_score * 0.6
        
        # åˆ¤æ–­
        is_relevant = relevance_score >= 0.6  # é˜ˆå€¼60%
        
        warning = None
        if relevance_score < 0.4:
            warning = f"ä»»åŠ¡ä¸¥é‡åç¦»æ ¸å¿ƒæ–¹å‘(ç›¸å…³åº¦{relevance_score*100:.0f}%)"
        elif relevance_score < 0.6:
            warning = f"ä»»åŠ¡å¯èƒ½åç¦»æ ¸å¿ƒæ–¹å‘(ç›¸å…³åº¦{relevance_score*100:.0f}%)"
        
        return {
            "relevance_score": relevance_score,
            "is_relevant": is_relevant,
            "matched_keywords": matched,
            "warning": warning
        }
    
    def _semantic_similarity(self, text1: str, text2: str) -> float:
        """è®¡ç®—è¯­ä¹‰ç›¸ä¼¼åº¦ï¼ˆç”¨MiniMaxï¼‰"""
        
        prompt = f"""è®¡ç®—ä»¥ä¸‹ä¸¤æ®µæ–‡æœ¬çš„è¯­ä¹‰ç›¸å…³åº¦ï¼ˆ0-1ï¼‰ï¼š

æ–‡æœ¬1ï¼ˆæ ¸å¿ƒæ–¹å‘ï¼‰ï¼š{text1}
æ–‡æœ¬2ï¼ˆä»»åŠ¡æ ‡é¢˜ï¼‰ï¼š{text2}

åªè¿”å›0-1ä¹‹é—´çš„æ•°å­—ï¼Œè¡¨ç¤ºç›¸å…³ç¨‹åº¦ã€‚
1.0 = å®Œå…¨ç›¸å…³
0.5 = éƒ¨åˆ†ç›¸å…³
0.0 = å®Œå…¨æ— å…³
"""
        
        response = minimax.chat([{"role": "user", "content": prompt}])
        
        try:
            score = float(response.get("content", "0.5").strip())
            return max(0.0, min(1.0, score))
        except:
            return 0.5  # é»˜è®¤ä¸­ç­‰ç›¸å…³
```

---

#### 4ï¸âƒ£ å¼ºåˆ¶æ–¹å‘çº åï¼ˆAuto Correctionï¼‰

```python
# åœ¨generate_taskså·¥å…·æ‰§è¡Œåï¼Œæ£€æŸ¥æ‰€æœ‰ç”Ÿæˆçš„ä»»åŠ¡
def validate_generated_tasks(tasks: List[Dict], core_direction: str) -> List[Dict]:
    """éªŒè¯ç”Ÿæˆçš„ä»»åŠ¡ï¼Œè¿‡æ»¤åç¦»æ–¹å‘çš„"""
    
    detector = DirectionDriftDetector(core_direction)
    
    validated_tasks = []
    rejected_tasks = []
    
    for task in tasks:
        check_result = detector.check_relevance(
            task["title"],
            task["description"]
        )
        
        if check_result["is_relevant"]:
            # é™„åŠ ç›¸å…³åº¦ä¿¡æ¯
            task["relevance_score"] = check_result["relevance_score"]
            validated_tasks.append(task)
        else:
            # æ‹’ç»åç¦»çš„ä»»åŠ¡
            rejected_tasks.append({
                "task": task,
                "reason": check_result["warning"]
            })
    
    # è®°å½•æ—¥å¿—
    if rejected_tasks:
        print(f"[DirectionGuard] âš ï¸ æ‹’ç»äº†{len(rejected_tasks)}ä¸ªåç¦»æ–¹å‘çš„ä»»åŠ¡")
        for rt in rejected_tasks:
            print(f"  âŒ {rt['task']['title']}: {rt['reason']}")
    
    # å¦‚æœå¤§éƒ¨åˆ†ä»»åŠ¡éƒ½è¢«æ‹’ç» â†’ è¯´æ˜ä¸¥é‡åç¦»
    if len(rejected_tasks) / len(tasks) > 0.5:
        print(f"[DirectionGuard] ğŸš¨ ä¸¥é‡åç¦»è­¦å‘Šï¼š{len(rejected_tasks)}/{len(tasks)}ä¸ªä»»åŠ¡è¢«æ‹’")
        # è§¦å‘å¼ºåˆ¶çº å
        trigger_forced_correction()
    
    return validated_tasks


def trigger_forced_correction():
    """å¼ºåˆ¶çº åï¼šé‡æ–°æ³¨å…¥æ ¸å¿ƒæ–¹å‘"""
    
    # å¼ºåˆ¶æ’å…¥çº åæ¶ˆæ¯
    correction_message = {
        "role": "user",
        "content": f"""ğŸš¨ æ–¹å‘åç¦»è­¦å‘Šï¼

ä½ ç”Ÿæˆçš„ä»»åŠ¡ä¸­è¶…è¿‡50%åç¦»äº†æ ¸å¿ƒæ–¹å‘ã€‚

è¯·ç«‹å³ï¼š
1. é‡æ–°é˜…è¯»ã€æ ¸å¿ƒæ–¹å‘ã€‘ï¼š{user_direction}
2. è°ƒç”¨detect_patterné‡æ–°è¯†åˆ«å·¥ä½œæ¨¡å¼
3. ç¡®ä¿åç»­ä»»åŠ¡ä¸æ ¸å¿ƒæ–¹å‘å¼ºç›¸å…³

å¦‚æœæ— æ³•ç”Ÿæˆç¬¦åˆæ–¹å‘çš„ä»»åŠ¡ï¼Œè¯·è°ƒç”¨pause_autonomousæš‚åœã€‚
"""
    }
    
    messages.append(correction_message)
```

---

#### 5ï¸âƒ£ æ–¹å‘ç›¸å…³åº¦ç›‘æ§ï¼ˆContinuous Monitoringï¼‰

```python
class DirectionComplianceMonitor:
    """æ–¹å‘éµå®ˆåº¦ç›‘æ§å™¨"""
    
    def __init__(self, core_direction: str):
        self.core_direction = core_direction
        self.task_history = []
        
    def record_task(self, task: Dict, relevance_score: float):
        """è®°å½•ä»»åŠ¡åŠå…¶ç›¸å…³åº¦"""
        self.task_history.append({
            "task": task,
            "relevance": relevance_score,
            "timestamp": time.time()
        })
    
    def get_compliance_trend(self, window_size: int = 10) -> Dict:
        """è·å–æ–¹å‘éµå®ˆåº¦è¶‹åŠ¿"""
        
        recent_tasks = self.task_history[-window_size:]
        
        if not recent_tasks:
            return {"trend": "unknown", "avg_relevance": 0}
        
        # è®¡ç®—å¹³å‡ç›¸å…³åº¦
        avg_relevance = sum(t["relevance"] for t in recent_tasks) / len(recent_tasks)
        
        # è¶‹åŠ¿åˆ†æ
        if len(recent_tasks) >= 2:
            first_half = recent_tasks[:len(recent_tasks)//2]
            second_half = recent_tasks[len(recent_tasks)//2:]
            
            avg_first = sum(t["relevance"] for t in first_half) / len(first_half)
            avg_second = sum(t["relevance"] for t in second_half) / len(second_half)
            
            if avg_second > avg_first + 0.1:
                trend = "improving"
            elif avg_second < avg_first - 0.1:
                trend = "declining"  # â† è­¦å‘Šï¼
            else:
                trend = "stable"
        else:
            trend = "unknown"
        
        return {
            "trend": trend,
            "avg_relevance": avg_relevance,
            "éœ€è¦çº å": avg_relevance < 0.6 or trend == "declining"
        }
```

---

## ğŸ”’ æ–¹å‘ä¿æŠ¤çš„å¤šé‡æœºåˆ¶

### æœºåˆ¶æ±‡æ€»

| æœºåˆ¶ | è§¦å‘æ—¶æœº | ä½œç”¨ | å¼ºåº¦ |
|------|---------|------|------|
| **é”šç‚¹æ¶ˆæ¯** | æ°¸ä¹…å­˜åœ¨ | æé†’æ ¸å¿ƒæ–¹å‘ | â­â­â­ |
| **System Promptå¼ºè°ƒ** | æ¯æ¬¡è°ƒç”¨ | å¼ºåŒ–è§„åˆ™ | â­â­â­â­ |
| **ç”Ÿæˆåè¿‡æ»¤** | æ¯æ‰¹ä»»åŠ¡ | æ‹’ç»åç¦»ä»»åŠ¡ | â­â­â­â­â­ |
| **å®šæœŸå›é¡¾** | æ¯10ä¸ªä»»åŠ¡ | ä¸»åŠ¨æ£€æŸ¥ | â­â­â­â­â­ |
| **è¶‹åŠ¿ç›‘æ§** | å®æ—¶ | é¢„è­¦åç¦» | â­â­â­â­ |
| **å¼ºåˆ¶çº å** | åç¦»50%+ | é‡ç½®æ–¹å‘ | â­â­â­â­â­ |

---

### å·¥å…·8: verify_directionï¼ˆæ–°å¢ï¼šæ–¹å‘éªŒè¯å·¥å…·ï¼‰

```python
{
    "name": "verify_direction",
    "description": "éªŒè¯å³å°†ç”Ÿæˆçš„ä»»åŠ¡æ˜¯å¦ç¬¦åˆæ ¸å¿ƒæ–¹å‘ï¼Œåœ¨send_requestä¹‹å‰è°ƒç”¨",
    "parameters": {
        "type": "object",
        "properties": {
            "task_title": {
                "type": "string",
                "description": "å¾…éªŒè¯çš„ä»»åŠ¡æ ‡é¢˜"
            },
            "task_description": {
                "type": "string",
                "description": "ä»»åŠ¡æè¿°"
            },
            "æ ¸å¿ƒæ–¹å‘": {
                "type": "string",
                "description": "é‡å¤æ ¸å¿ƒæ–¹å‘ï¼ˆå¼ºåŒ–è®°å¿†ï¼‰"
            },
            "relevance_analysis": {
                "type": "object",
                "properties": {
                    "is_relevant": {"type": "boolean"},
                    "relevance_score": {"type": "number"},
                    "reasoning": {"type": "string"},
                    "matched_keywords": {"type": "array", "items": {"type": "string"}}
                }
            },
            "decision": {
                "type": "string",
                "enum": ["approve", "reject", "uncertain"],
                "description": "æ˜¯å¦æ‰¹å‡†æ­¤ä»»åŠ¡"
            }
        },
        "required": ["task_title", "æ ¸å¿ƒæ–¹å‘", "relevance_analysis", "decision"]
    }
}

# å¼ºåˆ¶æµç¨‹ï¼š
# generate_tasks â†’ verify_direction â†’ send_request
#                         â†“ reject
#                    ä¸¢å¼ƒï¼Œä¸å‘é€
```

---

### ä½¿ç”¨verify_directionçš„å¼ºåˆ¶æµç¨‹

```python
# æ‰˜ç®¡Agentçš„å·¥ä½œæµç¨‹ï¼ˆå¼ºåˆ¶æ–¹å‘éªŒè¯ï¼‰

1. generate_tasks â†’ ç”Ÿæˆ10ä¸ªå€™é€‰
2. for each task:
     verify_direction(task)
     if decision == "approve":
         send_request(task)  âœ…
     else:
         skip  âŒ ä¸å‘é€
3. å¦‚æœè¿ç»­3ä¸ªä»»åŠ¡éƒ½è¢«reject â†’ è§¦å‘detect_patterné‡æ–°è¯†åˆ«
```

---

## ğŸ” æ¨¡å—1ï¼šå·¥ä½œæ¨¡å¼è¯†åˆ«å™¨

### åŠŸèƒ½ï¼šåˆ†æç”¨æˆ·æ­£åœ¨åšä»€ä¹ˆ

```python
# core/pattern_recognizer.py

class WorkPatternRecognizer:
    """å·¥ä½œæ¨¡å¼è¯†åˆ«å™¨"""
    
    def analyze_recent_activity(
        self, 
        recent_messages: List[Dict],
        recent_tasks: List[Dict]
    ) -> Dict:
        """
        åˆ†ææœ€è¿‘çš„æ´»åŠ¨æ¨¡å¼
        
        Returns:
            {
                "pattern_type": "document_generation",
                "ä¸»é¢˜": "æ–¹æ¡ˆæ–‡æ¡£ç¼–å†™",
                "é‡å¤æ“ä½œ": ["åˆ›å»ºmdæ–‡ä»¶", "å†™å…¥æ–¹æ¡ˆå†…å®¹"],
                "ç›®æ ‡ç›®å½•": "docs/about2Do",
                "æ–‡ä»¶æ¨¡å¼": "*.md",
                "estimated_topic_pool": 15,  # é¢„ä¼°è¿˜èƒ½ç”Ÿæˆå¤šå°‘ä¸ª
                "confidence": 0.92
            }
        """
        
        # è°ƒç”¨LLMåˆ†æ
        analysis_prompt = f"""åˆ†æä»¥ä¸‹æœ€è¿‘çš„å¯¹è¯å’Œä»»åŠ¡ï¼Œè¯†åˆ«ç”¨æˆ·çš„å·¥ä½œæ¨¡å¼ã€‚

æœ€è¿‘å¯¹è¯ï¼ˆæœ€è¿‘5è½®ï¼‰ï¼š
{format_messages(recent_messages)}

æœ€è¿‘ä»»åŠ¡ï¼ˆæœ€è¿‘10ä¸ªï¼‰ï¼š
{format_tasks(recent_tasks)}

è¯·è¯†åˆ«ï¼š
1. ç”¨æˆ·åœ¨é‡å¤åšä»€ä¹ˆï¼Ÿ
2. å·¥ä½œä¸»é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ
3. æ¶‰åŠå“ªäº›æ–‡ä»¶/ç›®å½•ï¼Ÿ
4. è¿˜èƒ½ç”Ÿæˆå¤šå°‘ç±»ä¼¼çš„ä»»åŠ¡ï¼Ÿ

è¿”å›JSONæ ¼å¼ï¼š
{{
    "pattern_type": "document_generation/code_refactoring/testing/...",
    "ä¸»é¢˜": "ç®€çŸ­æè¿°",
    "é‡å¤æ“ä½œ": ["æ“ä½œ1", "æ“ä½œ2"],
    "ç›®æ ‡ç›®å½•": "ç›¸å…³ç›®å½•",
    "estimated_topic_pool": 10,
    "confidence": 0.85
}}
"""
        
        response = llm.chat([
            {"role": "user", "content": analysis_prompt}
        ])
        
        return parse_pattern_analysis(response)
```

---

## ğŸ¯ æ¨¡å—2ï¼šè‡ªä¸»ä»»åŠ¡ç”Ÿæˆå™¨

### åŠŸèƒ½ï¼šåŸºäºæ¨¡å¼ç”Ÿæˆæ–°ä»»åŠ¡

```python
# core/task_generator.py

class AutonomousTaskGenerator:
    """è‡ªä¸»ä»»åŠ¡ç”Ÿæˆå™¨"""
    
    def generate_next_tasks(
        self,
        pattern: Dict,
        å·²ç”Ÿæˆä»»åŠ¡: List[str],
        max_tasks: int = 100
    ) -> List[Dict]:
        """
        åŸºäºå·¥ä½œæ¨¡å¼ç”Ÿæˆä¸‹ä¸€æ‰¹ä»»åŠ¡
        
        Args:
            pattern: å·¥ä½œæ¨¡å¼åˆ†æç»“æœ
            å·²ç”Ÿæˆä»»åŠ¡: å·²ç»ç”Ÿæˆè¿‡çš„ä»»åŠ¡åˆ—è¡¨ï¼ˆé¿å…é‡å¤ï¼‰
            max_tasks: æœ€å¤šç”Ÿæˆå¤šå°‘ä¸ª
            
        Returns:
            æ–°ä»»åŠ¡åˆ—è¡¨
        """
        
        generation_prompt = f"""åŸºäºä»¥ä¸‹å·¥ä½œæ¨¡å¼ï¼Œç”Ÿæˆ5-10ä¸ªç›¸å…³çš„æ–°ä»»åŠ¡ã€‚

å·¥ä½œæ¨¡å¼ï¼š
- ä¸»é¢˜ï¼š{pattern['ä¸»é¢˜']}
- ç±»å‹ï¼š{pattern['pattern_type']}
- å·²å®Œæˆï¼š{len(å·²ç”Ÿæˆä»»åŠ¡)}ä¸ªä»»åŠ¡

å·²ç”Ÿæˆçš„ä»»åŠ¡ï¼ˆé¿å…é‡å¤ï¼‰ï¼š
{chr(10).join(f'- {t}' for t in å·²ç”Ÿæˆä»»åŠ¡[-20:])}

è¦æ±‚ï¼š
1. ç”Ÿæˆä¸ä¸»é¢˜é«˜åº¦ç›¸å…³çš„æ–°ä»»åŠ¡
2. ä¸è¦é‡å¤å·²ç”Ÿæˆçš„
3. ä¿æŒåˆ›æ–°æ€§å’Œå®ç”¨æ€§
4. æŒ‰ä¼˜å…ˆçº§æ’åº

ç¤ºä¾‹ï¼ˆæ–¹æ¡ˆæ–‡æ¡£ç”Ÿæˆåœºæ™¯ï¼‰ï¼š
å¦‚æœä¸»é¢˜æ˜¯"Agentä¼˜åŒ–æ–¹æ¡ˆ"ï¼Œå¯ä»¥ç”Ÿæˆï¼š
- "å¤šæ¨¡å‹åˆ‡æ¢æ–¹æ¡ˆ"
- "æµå¼è¾“å‡ºä¼˜åŒ–æ–¹æ¡ˆ"  
- "å¹¶å‘æ‰§è¡Œæ–¹æ¡ˆ"
- "ç¼“å­˜ç­–ç•¥æ–¹æ¡ˆ"
ç­‰ç­‰

è¿”å›JSONæ ¼å¼ï¼š
[
    {{
        "title": "ä»»åŠ¡æ ‡é¢˜",
        "description": "è¯¦ç»†æè¿°",
        "priority": 8,
        "estimated_value": 7,
        "reasoning": "ä¸ºä»€ä¹ˆç”Ÿæˆè¿™ä¸ªä»»åŠ¡"
    }},
    ...
]
"""
        
        response = llm.chat([
            {"role": "system", "content": "ä½ æ˜¯åˆ›æ„ä»»åŠ¡ç”Ÿæˆä¸“å®¶"},
            {"role": "user", "content": generation_prompt}
        ])
        
        new_tasks = parse_generated_tasks(response)
        
        # è¿‡æ»¤å·²å­˜åœ¨çš„ï¼ˆåŒé‡æ£€æŸ¥ï¼‰
        filtered_tasks = [
            t for t in new_tasks
            if not self._is_duplicate(t, å·²ç”Ÿæˆä»»åŠ¡)
        ]
        
        return filtered_tasks[:max_tasks]
    
    def _is_duplicate(self, new_task: Dict, existing_tasks: List[str]) -> bool:
        """æ£€æµ‹ä»»åŠ¡æ˜¯å¦é‡å¤"""
        
        new_title = new_task["title"].lower()
        
        for existing in existing_tasks:
            # ç®€å•ç›¸ä¼¼åº¦æ£€æµ‹
            if self._similarity(new_title, existing.lower()) > 0.7:
                return True
        
        return False
    
    def _similarity(self, s1: str, s2: str) -> float:
        """è®¡ç®—å­—ç¬¦ä¸²ç›¸ä¼¼åº¦ï¼ˆç®€å•ç‰ˆï¼‰"""
        # å¯ä»¥ç”¨ç¼–è¾‘è·ç¦»æˆ–å…¶ä»–ç®—æ³•
        common_words = set(s1.split()) & set(s2.split())
        total_words = set(s1.split()) | set(s2.split())
        
        if not total_words:
            return 0.0
        
        return len(common_words) / len(total_words)
```

---

## ğŸ¤– æ¨¡å—3ï¼šè‡ªåŠ¨æ‰§è¡Œå¼•æ“

### æ‰˜ç®¡æ¨¡å¼ä¸»å¾ªç¯

```python
# core/autonomous_mode.py

class AutonomousExecutor:
    """æ‰˜ç®¡æ¨¡å¼æ‰§è¡Œå¼•æ“"""
    
    def __init__(self, agent: Agent):
        self.agent = agent
        self.pattern_recognizer = WorkPatternRecognizer()
        self.task_generator = AutonomousTaskGenerator()
        
        # å®‰å…¨é™åˆ¶
        self.max_tasks = 100           # æœ€å¤šç”Ÿæˆ100ä¸ªä»»åŠ¡
        self.max_runtime_hours = 8     # æœ€å¤šè¿è¡Œ8å°æ—¶
        self.max_cost = 10.0           # æœ€å¤šèŠ±è´¹Â¥10
        self.safety_check_interval = 10 # æ¯10ä¸ªä»»åŠ¡æ£€æŸ¥ä¸€æ¬¡
        
        # çŠ¶æ€
        self.is_running = False
        self.generated_tasks = []
        self.executed_tasks = []
        self.total_cost = 0.0
    
    async def start_autonomous_mode(
        self,
        context_history: List[Dict],
        config: Dict
    ) -> Dict:
        """
        å¯åŠ¨æ‰˜ç®¡æ¨¡å¼
        
        Args:
            context_history: å½“å‰å¯¹è¯å†å²
            config: æ‰˜ç®¡é…ç½®
                {
                    "max_tasks": 50,
                    "max_hours": 4,
                    "max_cost": 5.0,
                    "quality_threshold": 7.0
                }
        """
        
        print(f"\n{'='*80}")
        print("ğŸ¤– æ‰˜ç®¡æ¨¡å¼å¯åŠ¨")
        print(f"{'='*80}\n")
        
        # åº”ç”¨é…ç½®
        self.max_tasks = config.get("max_tasks", 100)
        self.max_runtime_hours = config.get("max_hours", 8)
        self.max_cost = config.get("max_cost", 10.0)
        quality_threshold = config.get("quality_threshold", 7.0)
        
        self.is_running = True
        start_time = time.time()
        
        # ========== æ­¥éª¤1ï¼šè¯†åˆ«å·¥ä½œæ¨¡å¼ ==========
        pattern = self.pattern_recognizer.analyze_recent_activity(
            recent_messages=context_history[-10:],
            recent_tasks=self.agent.get_recent_tasks()
        )
        
        print(f"[Autonomous] è¯†åˆ«åˆ°å·¥ä½œæ¨¡å¼:")
        print(f"  ç±»å‹: {pattern['pattern_type']}")
        print(f"  ä¸»é¢˜: {pattern['ä¸»é¢˜']}")
        print(f"  ç½®ä¿¡åº¦: {pattern['confidence']*100:.0f}%")
        
        if pattern['confidence'] < 0.7:
            return {
                "success": False,
                "message": "å·¥ä½œæ¨¡å¼ä¸å¤Ÿæ˜ç¡®ï¼Œæ— æ³•å¯åŠ¨æ‰˜ç®¡æ¨¡å¼",
                "suggestion": "è¯·å…ˆæ˜ç¡®å½“å‰çš„å·¥ä½œç›®æ ‡"
            }
        
        # ========== æ­¥éª¤2ï¼šæ‰˜ç®¡å¾ªç¯ ==========
        while self.is_running:
            # æ£€æŸ¥åœæ­¢æ¡ä»¶
            elapsed_hours = (time.time() - start_time) / 3600
            
            if len(self.executed_tasks) >= self.max_tasks:
                print(f"[Autonomous] è¾¾åˆ°ä»»åŠ¡æ•°é‡ä¸Šé™({self.max_tasks})")
                break
            
            if elapsed_hours >= self.max_runtime_hours:
                print(f"[Autonomous] è¾¾åˆ°è¿è¡Œæ—¶é—´ä¸Šé™({self.max_runtime_hours}å°æ—¶)")
                break
            
            if self.total_cost >= self.max_cost:
                print(f"[Autonomous] è¾¾åˆ°æˆæœ¬ä¸Šé™(Â¥{self.max_cost})")
                break
            
            # ç”Ÿæˆæ–°ä»»åŠ¡
            new_tasks = self.task_generator.generate_next_tasks(
                pattern=pattern,
                å·²ç”Ÿæˆä»»åŠ¡=[t["title"] for t in self.generated_tasks],
                max_tasks=5  # æ¯æ¬¡ç”Ÿæˆ5ä¸ª
            )
            
            if not new_tasks:
                print(f"[Autonomous] æ— æ³•ç”Ÿæˆæ›´å¤šä»»åŠ¡ï¼Œç»“æŸæ‰˜ç®¡")
                break
            
            # æ‰§è¡Œæ–°ä»»åŠ¡
            for task in new_tasks:
                if not self.is_running:
                    break
                
                print(f"\n[Autonomous] æ‰§è¡Œä»»åŠ¡: {task['title']}")
                
                # æ‰§è¡Œä»»åŠ¡
                result = await self._execute_autonomous_task(task, pattern)
                
                # è®°å½•
                self.generated_tasks.append(task)
                self.executed_tasks.append({
                    "task": task,
                    "result": result,
                    "timestamp": time.time()
                })
                
                # æ›´æ–°æˆæœ¬
                self.total_cost += result.get("cost", 0)
                
                # è´¨é‡æ£€æŸ¥
                if result.get("quality_score", 0) < quality_threshold:
                    print(f"  âš ï¸ è´¨é‡ä¸è¾¾æ ‡({result['quality_score']:.1f}<{quality_threshold})")
                
                # å®‰å…¨æ£€æŸ¥
                if len(self.executed_tasks) % self.safety_check_interval == 0:
                    if not await self._safety_check():
                        print(f"[Autonomous] å®‰å…¨æ£€æŸ¥æœªé€šè¿‡ï¼Œåœæ­¢æ‰˜ç®¡")
                        break
        
        # ========== æ­¥éª¤3ï¼šç”Ÿæˆæ€»ç»“æŠ¥å‘Š ==========
        report = self._generate_report()
        
        return {
            "success": True,
            "mode": "autonomous",
            "pattern": pattern,
            "tasks_generated": len(self.generated_tasks),
            "tasks_executed": len(self.executed_tasks),
            "total_cost": self.total_cost,
            "runtime_hours": (time.time() - start_time) / 3600,
            "report": report
        }
    
    async def _execute_autonomous_task(
        self, 
        task: Dict,
        pattern: Dict
    ) -> Dict:
        """æ‰§è¡Œå•ä¸ªè‡ªä¸»ç”Ÿæˆçš„ä»»åŠ¡"""
        
        # æ„å»ºä»»åŠ¡æè¿°
        task_message = f"""åŸºäºå½“å‰å·¥ä½œæ¨¡å¼ï¼Œæ‰§è¡Œä»¥ä¸‹ä»»åŠ¡ï¼š

ä»»åŠ¡ï¼š{task['title']}
æè¿°ï¼š{task['description']}
å·¥ä½œæ¨¡å¼ï¼š{pattern['ä¸»é¢˜']}

è¯·æŒ‰ç…§ä¹‹å‰çš„æ¨¡å¼å®Œæˆæ­¤ä»»åŠ¡ã€‚
"""
        
        # è°ƒç”¨Agentæ‰§è¡Œ
        result = await self.agent.run(
            user_message=task_message,
            context_history=[]  # ç‹¬ç«‹Contextï¼Œä¸ä¾èµ–å†å²
        )
        
        # è´¨é‡è¯„ä¼°
        quality_score = await self._evaluate_quality(task, result)
        result["quality_score"] = quality_score
        result["cost"] = self._estimate_cost(result)
        
        return result
    
    async def _evaluate_quality(self, task: Dict, result: Dict) -> float:
        """è¯„ä¼°ä»»åŠ¡æ‰§è¡Œè´¨é‡ï¼ˆ0-10åˆ†ï¼‰"""
        
        evaluation_prompt = f"""è¯„ä¼°ä»¥ä¸‹ä»»åŠ¡çš„æ‰§è¡Œè´¨é‡ï¼ˆ0-10åˆ†ï¼‰ï¼š

ä»»åŠ¡ï¼š{task['title']}
æœŸæœ›ï¼š{task['description']}

æ‰§è¡Œç»“æœï¼š
{result.get('message', '')[:500]}

è¯„åˆ†æ ‡å‡†ï¼š
- 10åˆ†ï¼šå®Œç¾å®Œæˆï¼Œè¶…å‡ºé¢„æœŸ
- 7-9åˆ†ï¼šå®Œæˆè´¨é‡é«˜
- 5-6åˆ†ï¼šåŸºæœ¬å®Œæˆ
- 3-4åˆ†ï¼šéƒ¨åˆ†å®Œæˆ
- 0-2åˆ†ï¼šå¤±è´¥æˆ–è´¨é‡å·®

åªè¿”å›æ•°å­—åˆ†æ•°ã€‚
"""
        
        response = llm.chat([
            {"role": "user", "content": evaluation_prompt}
        ])
        
        try:
            score = float(response.get("content", "5").strip())
            return max(0.0, min(10.0, score))
        except:
            return 5.0
    
    async def _safety_check(self) -> bool:
        """å®‰å…¨æ£€æŸ¥"""
        
        # æ£€æŸ¥1ï¼šæ˜¯å¦ç”Ÿæˆäº†å±é™©å†…å®¹
        recent_results = self.executed_tasks[-10:]
        
        for item in recent_results:
            result = item["result"]
            
            # æ£€æµ‹å±é™©æ“ä½œ
            if self._contains_dangerous_operations(result):
                print(f"[Safety] âš ï¸ æ£€æµ‹åˆ°å±é™©æ“ä½œ")
                return False
            
            # æ£€æµ‹é‡å¤å¤±è´¥
            if not result.get("success"):
                print(f"[Safety] âš ï¸ ä»»åŠ¡æ‰§è¡Œå¤±è´¥")
                # è¿ç»­3æ¬¡å¤±è´¥ â†’ åœæ­¢
                if self._count_consecutive_failures() >= 3:
                    return False
        
        # æ£€æŸ¥2ï¼šæˆæœ¬æ˜¯å¦å¼‚å¸¸
        if self.total_cost > self.max_cost * 0.9:
            print(f"[Safety] âš ï¸ æ¥è¿‘æˆæœ¬ä¸Šé™")
            return False
        
        return True
    
    def _generate_report(self) -> str:
        """ç”Ÿæˆæ‰˜ç®¡æ‰§è¡ŒæŠ¥å‘Š"""
        
        # ç»Ÿè®¡
        total_generated = len(self.generated_tasks)
        total_executed = len(self.executed_tasks)
        successful = sum(1 for t in self.executed_tasks if t["result"].get("success"))
        
        high_quality = sum(
            1 for t in self.executed_tasks 
            if t["result"].get("quality_score", 0) >= 8.0
        )
        
        # ç”ŸæˆMarkdownæŠ¥å‘Š
        report = f"""# æ‰˜ç®¡æ¨¡å¼æ‰§è¡ŒæŠ¥å‘Š

## ğŸ“Š æ‰§è¡Œç»Ÿè®¡

- **ç”Ÿæˆä»»åŠ¡**: {total_generated}ä¸ª
- **æ‰§è¡Œä»»åŠ¡**: {total_executed}ä¸ª
- **æˆåŠŸç‡**: {successful/total_executed*100:.1f}%
- **é«˜è´¨é‡**: {high_quality}ä¸ª (è¯„åˆ†â‰¥8.0)
- **æ€»æˆæœ¬**: Â¥{self.total_cost:.4f}
- **è¿è¡Œæ—¶é•¿**: {self._get_runtime():.1f}å°æ—¶

## ğŸ“‹ ä»»åŠ¡æ¸…å•

### âœ… é«˜è´¨é‡ä»»åŠ¡ (æ¨èæ‰§è¡Œ)

{self._format_high_quality_tasks()}

### âš ï¸ ä¸­ç­‰è´¨é‡ä»»åŠ¡ (å¯é€‰æ‰§è¡Œ)

{self._format_medium_quality_tasks()}

### âŒ ä½è´¨é‡ä»»åŠ¡ (å»ºè®®å¿½ç•¥)

{self._format_low_quality_tasks()}

## ğŸ’¡ å»ºè®®

{self._generate_suggestions()}
"""
        
        return report
```

---

## ğŸ¨ æ‰˜ç®¡æ¨¡å¼é…ç½®ç•Œé¢

### UIè®¾è®¡

```html
<div class="autonomous-mode-panel">
    <div class="panel-header">
        <h3>ğŸ¤– æ‰˜ç®¡æ¨¡å¼</h3>
        <div class="status-badge" id="auto-status">
            æœªæ¿€æ´»
        </div>
    </div>
    
    <div class="panel-body">
        <!-- å·¥ä½œæ¨¡å¼è¯†åˆ«ç»“æœ -->
        <div class="pattern-detected" id="pattern-info">
            <h4>è¯†åˆ«åˆ°çš„å·¥ä½œæ¨¡å¼</h4>
            <div class="pattern-card">
                <div class="pattern-type">ğŸ“ æ–¹æ¡ˆæ–‡æ¡£ç¼–å†™</div>
                <div class="pattern-details">
                    <span>å·²å®Œæˆ: 6ä¸ªæ–¹æ¡ˆ</span>
                    <span>é¢„ä¼°è¿˜èƒ½ç”Ÿæˆ: 15ä¸ª</span>
                    <span>ç½®ä¿¡åº¦: 92%</span>
                </div>
            </div>
        </div>
        
        <!-- é…ç½®é€‰é¡¹ -->
        <div class="autonomous-config">
            <h4>âš™ï¸ æ‰˜ç®¡é…ç½®</h4>
            
            <label>
                æœ€å¤§ä»»åŠ¡æ•°
                <input type="number" id="auto-max-tasks" value="50" min="5" max="200">
            </label>
            
            <label>
                è¿è¡Œæ—¶é•¿ï¼ˆå°æ—¶ï¼‰
                <input type="number" id="auto-max-hours" value="4" min="0.5" max="24" step="0.5">
            </label>
            
            <label>
                æˆæœ¬ä¸Šé™ï¼ˆå…ƒï¼‰
                <input type="number" id="auto-max-cost" value="5.00" min="0.5" max="50" step="0.5">
            </label>
            
            <label>
                è´¨é‡é˜ˆå€¼ï¼ˆ0-10ï¼‰
                <input type="range" id="auto-quality" value="7" min="5" max="10" step="0.5">
                <span id="quality-value">7.0</span>
            </label>
        </div>
        
        <!-- é¢„ä¼° -->
        <div class="autonomous-estimate">
            <h4>ğŸ“Š é¢„ä¼°</h4>
            <div class="estimate-grid">
                <div class="estimate-item">
                    <span class="label">é¢„è®¡ç”Ÿæˆ</span>
                    <span class="value">~45ä¸ªä»»åŠ¡</span>
                </div>
                <div class="estimate-item">
                    <span class="label">é¢„è®¡è€—æ—¶</span>
                    <span class="value">~3.5å°æ—¶</span>
                </div>
                <div class="estimate-item">
                    <span class="label">é¢„è®¡æˆæœ¬</span>
                    <span class="value">Â¥3.80</span>
                </div>
            </div>
        </div>
        
        <!-- æ§åˆ¶æŒ‰é’® -->
        <div class="autonomous-actions">
            <button class="btn-primary btn-large" onclick="startAutonomousMode()">
                ğŸš€ å¯åŠ¨æ‰˜ç®¡æ¨¡å¼
            </button>
            <button class="btn-danger" onclick="stopAutonomousMode()" disabled id="btn-stop">
                â¸ï¸ åœæ­¢æ‰˜ç®¡
            </button>
        </div>
        
        <!-- å®æ—¶è¿›åº¦ -->
        <div class="autonomous-progress" id="auto-progress" style="display:none;">
            <h4>â³ æ‰§è¡Œä¸­...</h4>
            <div class="progress-stats">
                <div>å·²ç”Ÿæˆ: <strong id="tasks-generated">0</strong> / 50</div>
                <div>å·²æ‰§è¡Œ: <strong id="tasks-executed">0</strong> / 50</div>
                <div>æˆåŠŸç‡: <strong id="success-rate">0%</strong></div>
                <div>å·²ç”¨æˆæœ¬: <strong id="cost-used">Â¥0.00</strong></div>
                <div>è¿è¡Œæ—¶é•¿: <strong id="runtime">0åˆ†é’Ÿ</strong></div>
            </div>
            
            <div class="latest-task">
                <strong>æœ€æ–°ä»»åŠ¡:</strong>
                <span id="latest-task-title">-</span>
            </div>
        </div>
    </div>
</div>
```

---

## ğŸ›¡ï¸ å®‰å…¨æœºåˆ¶

### å¤šé‡å®‰å…¨è¾¹ç•Œ

```python
class SafetyController:
    """æ‰˜ç®¡æ¨¡å¼å®‰å…¨æ§åˆ¶å™¨"""
    
    # å±é™©æ“ä½œé»‘åå•
    DANGEROUS_OPERATIONS = [
        "delete_file",           # åˆ é™¤æ–‡ä»¶
        "run_terminal",          # ç»ˆç«¯å‘½ä»¤ï¼ˆé™¤éç™½åå•ï¼‰
        "edit_file.*\.env",      # ä¿®æ”¹ç¯å¢ƒå˜é‡
        "write_file.*config",    # ä¿®æ”¹é…ç½®ï¼ˆéœ€è°¨æ…ï¼‰
    ]
    
    # å…è®¸çš„æ–‡ä»¶æ“ä½œèŒƒå›´
    ALLOWED_DIRECTORIES = [
        "docs/about2Do/",        # æ–¹æ¡ˆæ–‡æ¡£ç›®å½•
        "temp/",                 # ä¸´æ—¶ç›®å½•
        "output/autonomous/"     # æ‰˜ç®¡è¾“å‡ºç›®å½•
    ]
    
    def validate_autonomous_task(self, task: Dict) -> tuple[bool, str]:
        """éªŒè¯è‡ªä¸»ä»»åŠ¡æ˜¯å¦å®‰å…¨"""
        
        # æ£€æŸ¥1ï¼šæ“ä½œç±»å‹
        if self._contains_dangerous_op(task):
            return False, "åŒ…å«å±é™©æ“ä½œ"
        
        # æ£€æŸ¥2ï¼šæ–‡ä»¶èŒƒå›´
        if not self._within_allowed_dirs(task):
            return False, "æ“ä½œè¶…å‡ºå…è®¸èŒƒå›´"
        
        # æ£€æŸ¥3ï¼šä»»åŠ¡åˆç†æ€§
        if not self._is_reasonable_task(task):
            return False, "ä»»åŠ¡ä¸åˆç†"
        
        return True, "å®‰å…¨"
    
    def monitor_execution(self, executed_tasks: List[Dict]) -> Dict:
        """ç›‘æ§æ‰§è¡ŒçŠ¶æ€"""
        
        alerts = []
        
        # ç›‘æ§1ï¼šé‡å¤ç‡
        duplicate_rate = self._calculate_duplicate_rate(executed_tasks)
        if duplicate_rate > 0.3:
            alerts.append({
                "level": "warning",
                "message": f"ä»»åŠ¡é‡å¤ç‡é«˜({duplicate_rate*100:.0f}%)"
            })
        
        # ç›‘æ§2ï¼šå¤±è´¥ç‡
        failure_rate = self._calculate_failure_rate(executed_tasks)
        if failure_rate > 0.3:
            alerts.append({
                "level": "error",
                "message": f"ä»»åŠ¡å¤±è´¥ç‡é«˜({failure_rate*100:.0f}%)"
            })
        
        # ç›‘æ§3ï¼šè´¨é‡ä¸‹é™
        if self._is_quality_declining(executed_tasks):
            alerts.append({
                "level": "warning",
                "message": "ä»»åŠ¡è´¨é‡æŒç»­ä¸‹é™"
            })
        
        return {
            "status": "error" if any(a["level"] == "error" for a in alerts) else "ok",
            "alerts": alerts
        }
```

---

## ğŸ“Š æ‰˜ç®¡æ‰§è¡Œç¤ºä¾‹

### åœºæ™¯ï¼šæ–¹æ¡ˆæ–‡æ¡£ç”Ÿæˆ

```
19:30 ç”¨æˆ·å¯åŠ¨æ‰˜ç®¡æ¨¡å¼
é…ç½®ï¼š
  - max_tasks: 50
  - max_hours: 8
  - max_cost: Â¥5.00
  - quality_threshold: 7.0

è¯†åˆ«æ¨¡å¼ï¼š
  - ç±»å‹: document_generation
  - ä¸»é¢˜: Agentä¼˜åŒ–æ–¹æ¡ˆæ–‡æ¡£
  - ç›®æ ‡ç›®å½•: docs/about2Do/
  - å·²å®Œæˆ: 6ä¸ª

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

19:35 ç¬¬1æ‰¹ä»»åŠ¡ç”Ÿæˆï¼ˆ5ä¸ªï¼‰
  1. "APIé™æµä¸é™çº§æ–¹æ¡ˆ"
  2. "å¤šæ¨¡å‹è´Ÿè½½å‡è¡¡æ–¹æ¡ˆ"  
  3. "ç¼“å­˜ç­–ç•¥è®¾è®¡æ–¹æ¡ˆ"
  4. "å¹¶å‘æ‰§è¡Œä¼˜åŒ–æ–¹æ¡ˆ"
  5. "æµå¼è¾“å‡ºå®ç°æ–¹æ¡ˆ"

19:36 å¼€å§‹æ‰§è¡ŒTask 1
  â†’ æˆåŠŸï¼Œè´¨é‡è¯„åˆ†: 8.5
  â†’ æˆæœ¬: Â¥0.08
  
19:41 å¼€å§‹æ‰§è¡ŒTask 2
  â†’ æˆåŠŸï¼Œè´¨é‡è¯„åˆ†: 8.2
  â†’ æˆæœ¬: Â¥0.09
  
... (æŒç»­æ‰§è¡Œ)

21:00 ç¬¬2æ‰¹ä»»åŠ¡ç”Ÿæˆï¼ˆ5ä¸ªï¼‰
  6. "Agenté›†ç¾¤éƒ¨ç½²æ–¹æ¡ˆ"
  7. "ç‰ˆæœ¬ç®¡ç†ä¸å›æ»šæ–¹æ¡ˆ"
  ...

... (æŒç»­åˆ°åœæ­¢æ¡ä»¶)

03:00 è¾¾åˆ°ä»»åŠ¡æ•°é‡ä¸Šé™(50ä¸ª)
æˆ–
07:00 è¾¾åˆ°è¿è¡Œæ—¶é•¿ä¸Šé™(8å°æ—¶)
æˆ–
æå‰è¾¾åˆ°æˆæœ¬ä¸Šé™

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ç”ŸæˆæŠ¥å‘Šï¼š
  âœ… æˆåŠŸç”Ÿæˆ: 47ä¸ªæ–¹æ¡ˆ
  âœ… é«˜è´¨é‡: 35ä¸ª (â‰¥8.0åˆ†)
  âš ï¸ ä¸­ç­‰è´¨é‡: 10ä¸ª (6.0-7.9åˆ†)
  âŒ ä½è´¨é‡: 2ä¸ª (<6.0åˆ†)
  ğŸ’° æ€»æˆæœ¬: Â¥4.82
  â±ï¸ è¿è¡Œæ—¶é•¿: 7.5å°æ—¶
```

---

## ğŸ¯ ä»»åŠ¡ç”Ÿæˆç­–ç•¥

### æ‰©æ•£å¼ç”Ÿæˆï¼ˆé¿å…é‡å¤ï¼‰

```python
class TaskGenerationStrategy:
    """ä»»åŠ¡ç”Ÿæˆç­–ç•¥"""
    
    def generate_with_diversity(
        self,
        base_theme: str,
        å·²ç”Ÿæˆ: List[str]
    ) -> List[Dict]:
        """
        æ‰©æ•£å¼ç”Ÿæˆï¼ˆä¿è¯å¤šæ ·æ€§ï¼‰
        
        ç­–ç•¥ï¼š
        1. æ ¸å¿ƒä¸»é¢˜çš„ç›´æ¥å˜ä½“ï¼ˆ3ä¸ªï¼‰
        2. ç›¸å…³é¢†åŸŸçš„æ¨ªå‘æ‰©å±•ï¼ˆ2ä¸ªï¼‰
        3. æ·±åº¦æŒ–æ˜çš„çºµå‘æ‰©å±•ï¼ˆ2ä¸ªï¼‰
        4. åˆ›æ–°æ€§æ¢ç´¢ï¼ˆ1ä¸ªï¼‰
        """
        
        generation_prompt = f"""åŸºäºä¸»é¢˜"{base_theme}"ï¼Œç”Ÿæˆ8ä¸ªå¤šæ ·åŒ–çš„ä»»åŠ¡ã€‚

å·²ç”Ÿæˆï¼š
{chr(10).join(å·²ç”Ÿæˆ[-20:])}

ç”Ÿæˆç­–ç•¥ï¼š
1. æ ¸å¿ƒå˜ä½“ï¼ˆ3ä¸ªï¼‰ï¼šä¸»é¢˜çš„ä¸åŒè§’åº¦
   ç¤ºä¾‹ï¼šå¦‚æœä¸»é¢˜æ˜¯"Contextç®¡ç†"
   â†’ "Contextå‹ç¼©ç®—æ³•"
   â†’ "Contextå¹¶å‘è®¿é—®"
   â†’ "ContextæŒä¹…åŒ–"

2. æ¨ªå‘æ‰©å±•ï¼ˆ2ä¸ªï¼‰ï¼šç›¸å…³ä½†ä¸åŒçš„é¢†åŸŸ
   â†’ "Memoryç®¡ç†æ–¹æ¡ˆ"
   â†’ "Cacheç­–ç•¥è®¾è®¡"

3. çºµå‘æ·±æŒ–ï¼ˆ2ä¸ªï¼‰ï¼šæŸä¸ªç‚¹çš„æ·±å…¥
   â†’ "Contextå‹ç¼©çš„LZ4ç®—æ³•å®ç°"
   â†’ "Contextçš„å‘é‡åŒ–æ£€ç´¢"

4. åˆ›æ–°æ¢ç´¢ï¼ˆ1ä¸ªï¼‰ï¼šå¤§èƒ†çš„æ–°æƒ³æ³•
   â†’ "åŸºäºå›¾ç¥ç»ç½‘ç»œçš„Contexté‡è¦åº¦é¢„æµ‹"

è¦æ±‚ï¼š
- ä¸ä¸»é¢˜ç›¸å…³ä½†ä¸é‡å¤
- æœ‰å®é™…ä»·å€¼
- æŠ€æœ¯å¯è¡Œ

è¿”å›JSONæ•°ç»„ã€‚
"""
        
        response = llm.chat([{"role": "user", "content": generation_prompt}])
        return parse_tasks(response)
```

---

## â¸ï¸ ç”¨æˆ·æ§åˆ¶æœºåˆ¶

### ä¸­æ–­ä¸æ¢å¤

```python
class AutonomousExecutor:
    
    def pause(self):
        """æš‚åœæ‰˜ç®¡æ¨¡å¼"""
        self.is_running = False
        print("[Autonomous] å·²æš‚åœ")
        
        # ä¿å­˜å½“å‰çŠ¶æ€
        self._save_state()
    
    def resume(self):
        """æ¢å¤æ‰˜ç®¡æ¨¡å¼"""
        # åŠ è½½çŠ¶æ€
        self._load_state()
        
        self.is_running = True
        print("[Autonomous] å·²æ¢å¤")
        
        # ç»§ç»­æ‰§è¡Œ
        asyncio.create_task(self._continue_execution())
    
    def stop(self):
        """å®Œå…¨åœæ­¢"""
        self.is_running = False
        
        # ç”ŸæˆæŠ¥å‘Š
        report = self._generate_report()
        
        # ä¿å­˜æŠ¥å‘Š
        self._save_report(report)
        
        print("[Autonomous] å·²åœæ­¢ï¼ŒæŠ¥å‘Šå·²ç”Ÿæˆ")
```

---

## ğŸ“± å®æ—¶é€šçŸ¥

### é˜¶æ®µæ€§é€šçŸ¥ç”¨æˆ·

```python
class AutonomousNotifier:
    """æ‰˜ç®¡æ¨¡å¼é€šçŸ¥å™¨"""
    
    NOTIFICATION_EVENTS = [
        "æ¯10ä¸ªä»»åŠ¡",
        "æ¯1å°æ—¶",
        "è¾¾åˆ°50%è¿›åº¦",
        "å‘ç°é«˜è´¨é‡ç»“æœ",
        "å‡ºç°å®‰å…¨è­¦å‘Š"
    ]
    
    def notify(self, event: str, data: Dict):
        """å‘é€é€šçŸ¥"""
        
        # å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼é€šçŸ¥
        # 1. å‰ç«¯Toastï¼ˆå¦‚æœå‰ç«¯å¼€ç€ï¼‰
        # 2. ç³»ç»Ÿé€šçŸ¥ï¼ˆWindowsé€šçŸ¥ï¼‰
        # 3. é‚®ä»¶ï¼ˆå¯é€‰ï¼‰
        # 4. ä¼ä¸šå¾®ä¿¡/é’‰é’‰ï¼ˆå¯é€‰ï¼‰
        
        message = self._format_notification(event, data)
        
        # å‰ç«¯é€šçŸ¥
        if frontend_connected:
            send_to_frontend({
                "type": "autonomous_notification",
                "event": event,
                "message": message,
                "data": data
            })
        
        # Windowsé€šçŸ¥
        self._show_windows_notification(message)
```

---

## âš ï¸ é£é™©ä¸æŒ‘æˆ˜

### é£é™©1ï¼šä»»åŠ¡è´¨é‡ä¸‹é™

```
é—®é¢˜ï¼š
  ç”Ÿæˆ50ä¸ªä»»åŠ¡ï¼Œåé¢çš„è´¨é‡è¶Šæ¥è¶Šå·®
  â†’ é‡å¤ã€æ— æ„ä¹‰çš„ä»»åŠ¡

è§£å†³ï¼š
  âœ… è´¨é‡é˜ˆå€¼ï¼šä½äº7åˆ†åœæ­¢ç”Ÿæˆ
  âœ… ç›¸ä¼¼åº¦æ£€æµ‹ï¼šé‡å¤çš„ä¸ç”Ÿæˆ
  âœ… äººå·¥å®¡æ ¸ï¼šé«˜è´¨é‡ä»»åŠ¡äººå·¥ç­›é€‰
```

### é£é™©2ï¼šèµ„æºå¤±æ§

```
é—®é¢˜ï¼š
  è¿è¡Œä¸€æ™šä¸Šï¼Œæˆæœ¬çˆ†ç‚¸

è§£å†³ï¼š
  âœ… æˆæœ¬ä¸Šé™ï¼šÂ¥10ç¡¬æ€§é™åˆ¶
  âœ… æ—¶é—´ä¸Šé™ï¼š8å°æ—¶è‡ªåŠ¨åœæ­¢
  âœ… å®æ—¶ç›‘æ§ï¼šæ¯10ä¸ªä»»åŠ¡æ£€æŸ¥ä¸€æ¬¡
```

### é£é™©3ï¼šç”Ÿæˆå±é™©æ“ä½œ

```
é—®é¢˜ï¼š
  è‡ªä¸»ç”Ÿæˆäº†åˆ é™¤æ–‡ä»¶çš„ä»»åŠ¡

è§£å†³ï¼š
  âœ… æ“ä½œç™½åå•ï¼šåªå…è®¸å®‰å…¨æ“ä½œ
  âœ… ç›®å½•é™åˆ¶ï¼šåªèƒ½åœ¨æŒ‡å®šç›®å½•
  âœ… äººå·¥å®¡æ ¸ï¼šå±é™©æ“ä½œéœ€ç¡®è®¤
```

---

## ğŸ¯ å®æ–½è·¯çº¿å›¾

### Phase 1: MVPï¼ˆ3å¤©ï¼‰
- [ ] WorkPatternRecognizer
- [ ] AutonomousTaskGenerator
- [ ] åŸºç¡€æ‰§è¡Œå¾ªç¯
- [ ] ç®€å•å®‰å…¨æ£€æŸ¥

### Phase 2: å®‰å…¨ä¸æ§åˆ¶ï¼ˆ2å¤©ï¼‰
- [ ] SafetyController
- [ ] å¤šé‡å®‰å…¨è¾¹ç•Œ
- [ ] æš‚åœ/æ¢å¤æœºåˆ¶
- [ ] è´¨é‡è¯„ä¼°

### Phase 3: ç”¨æˆ·ä½“éªŒï¼ˆ2å¤©ï¼‰
- [ ] å‰ç«¯æ§åˆ¶ç•Œé¢
- [ ] å®æ—¶è¿›åº¦å±•ç¤º
- [ ] é€šçŸ¥ç³»ç»Ÿ
- [ ] æŠ¥å‘Šç”Ÿæˆ

### Phase 4: ä¼˜åŒ–å®Œå–„ï¼ˆ3å¤©ï¼‰
- [ ] ä»»åŠ¡å»é‡ä¼˜åŒ–
- [ ] æ‰©æ•£å¼ç”Ÿæˆ
- [ ] æˆæœ¬ä¼˜åŒ–
- [ ] ç›‘æ§Dashboard

---

## ğŸ’¡ åˆ›æ–°äº®ç‚¹

1. **è‡ªä¸»ä»»åŠ¡ç”Ÿæˆ** - AIç†è§£ä½ åœ¨åšä»€ä¹ˆï¼Œä¸»åŠ¨ç”Ÿæˆç›¸å…³ä»»åŠ¡
2. **æ‰¹é‡æ‰§è¡Œ** - æ— éœ€äººå·¥å¹²é¢„ï¼Œè‡ªåŠ¨æ‰§è¡Œ
3. **è´¨é‡ä¿è¯** - è‡ªåŠ¨è¯„åˆ†ï¼Œç­›é€‰é«˜è´¨é‡ç»“æœ
4. **å®‰å…¨å¯æ§** - å¤šé‡è¾¹ç•Œï¼Œé˜²æ­¢å¤±æ§
5. **æˆæœ¬é€æ˜** - å®æ—¶ç›‘æ§ï¼Œä¸Šé™ä¿æŠ¤

---

## ğŸ“Š åº”ç”¨åœºæ™¯

### åœºæ™¯1ï¼šæ–¹æ¡ˆæ–‡æ¡£æ‰¹é‡ç”Ÿæˆ
```
è¾“å…¥ï¼šè®©Agentå†™3ä¸ªæ–¹æ¡ˆ
æ‰˜ç®¡ï¼šè‡ªåŠ¨ç”Ÿæˆå¹¶æ‰§è¡Œ50ä¸ªç›¸å…³æ–¹æ¡ˆ
è¾“å‡ºï¼š50ä¸ªæ–¹æ¡ˆï¼Œç­›é€‰20ä¸ªæœ‰ä»·å€¼çš„
```

### åœºæ™¯2ï¼šä»£ç é‡æ„ä»»åŠ¡
```
è¾“å…¥ï¼šé‡æ„authæ¨¡å—
æ‰˜ç®¡ï¼šè‡ªåŠ¨ç”Ÿæˆç›¸å…³é‡æ„å­ä»»åŠ¡
  - æå–å…¬å…±å‡½æ•°
  - ç»Ÿä¸€é”™è¯¯å¤„ç†
  - æ·»åŠ ç±»å‹æ³¨è§£
  - ä¼˜åŒ–å¯¼å…¥
  ...
```

### åœºæ™¯3ï¼šæµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ
```
è¾“å…¥ï¼šä¸ºæŸä¸ªæ¨¡å—å†™æµ‹è¯•
æ‰˜ç®¡ï¼šè‡ªåŠ¨ç”Ÿæˆå…¨é¢çš„æµ‹è¯•ç”¨ä¾‹
  - æ­£å¸¸æµç¨‹æµ‹è¯•
  - è¾¹ç•Œæ¡ä»¶æµ‹è¯•
  - å¼‚å¸¸å¤„ç†æµ‹è¯•
  - æ€§èƒ½æµ‹è¯•
  ...
```

---

## ğŸ¯ æ€»ç»“

### æ ¸å¿ƒä»·å€¼

**è®©AgentçœŸæ­£"è‡ªä¸»"å·¥ä½œï¼Œè§£æ”¾äººåŠ›**

- ğŸ¤– **è‡ªä¸»ç”Ÿæˆ**ï¼šç†è§£å·¥ä½œæ¨¡å¼ï¼Œç”Ÿæˆç›¸å…³ä»»åŠ¡
- ğŸš€ **æ‰¹é‡æ‰§è¡Œ**ï¼šä¸€æ¬¡é…ç½®ï¼ŒæŒç»­å·¥ä½œ
- ğŸ¯ **è´¨é‡ä¿è¯**ï¼šè‡ªåŠ¨è¯„åˆ†ç­›é€‰
- ğŸ›¡ï¸ **å®‰å…¨å¯æ§**ï¼šå¤šé‡é™åˆ¶é˜²å¤±æ§
- ğŸ’° **æˆæœ¬é€æ˜**ï¼šé¢„ç®—æ§åˆ¶

### é€‚ç”¨åœºæ™¯

âœ… **æ‰¹é‡åˆ›ä½œ**ï¼ˆæ–¹æ¡ˆã€æ–‡æ¡£ã€ä»£ç æ¨¡æ¿ï¼‰  
âœ… **ç³»ç»Ÿæ€§ä¼˜åŒ–**ï¼ˆé‡æ„ã€æµ‹è¯•ã€æ–‡æ¡£è¡¥å…¨ï¼‰  
âœ… **æ¢ç´¢æ€§ä»»åŠ¡**ï¼ˆå¤šæ–¹æ¡ˆå¯¹æ¯”ã€æŠ€æœ¯è°ƒç ”ï¼‰

### é£é™©è¯„ä¼°

âš ï¸ **ä¸­é«˜é£é™©ï¼Œéœ€è¦ä¸¥æ ¼çš„å®‰å…¨æœºåˆ¶**

å»ºè®®ï¼š
1. MVPå…ˆåœ¨å—é™ç¯å¢ƒæµ‹è¯•
2. é€æ­¥æ”¾å¼€æƒé™
3. æŒç»­ç›‘æ§ä¼˜åŒ–

**è¿™æ˜¯ä¸€ä¸ªå¤§èƒ†ä¸”æœ‰ä»·å€¼çš„åˆ›æ–°ï¼** ğŸŒŸğŸš€ğŸ¤–

---

## ğŸ’­ å“²å­¦æ€è€ƒ

è¿™ä¸ªåŠŸèƒ½è®©Agentä»"å·¥å…·"è¿›åŒ–ä¸º"åŒäº‹"ï¼š
- ä¸å†æ˜¯è¢«åŠ¨ç­‰å¾…æŒ‡ä»¤
- è€Œæ˜¯ä¸»åŠ¨ç†è§£å·¥ä½œã€ç”Ÿæˆä»»åŠ¡ã€è‡ªä¸»æ‰§è¡Œ
- äººç±»åªéœ€å®šä¹‰æ–¹å‘å’Œè¾¹ç•Œ
- Agentåœ¨è¾¹ç•Œå†…è‡ªä¸»æ¢ç´¢

**è¿™æ˜¯é€šå¾€AGIçš„ä¸€å°æ­¥ï¼** ğŸ¯

